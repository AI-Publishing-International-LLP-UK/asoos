<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ASOOS.2100.Cool - Diamond SAO Enhanced Owner Interface</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <!-- Enterprise-grade icon solution - Multiple fallbacks -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" crossorigin="anonymous">
  <style>
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background: #0a0a0a;
      color: #ffffff;
      overflow-x: hidden;
      overflow-y: auto;
      min-height: 100vh;
    }

    /* Diamond CLI Enhancement Styles */
    .diamond-enhanced {
      background: linear-gradient(135deg, #4c1d95 0%, #7c3aed 50%, #a855f7 100%);
      border: 2px solid rgba(124, 58, 237, 0.5);
      box-shadow: 0 0 20px rgba(124, 58, 237, 0.3);
    }

    .diamond-mode-indicator {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      background: rgba(255, 215, 0, 0.1);
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-radius: 12px;
      font-size: 8px;
      font-weight: 600;
      color: #FFD700;
    }

    .diamond-icon-small {
      width: 8px;
      height: 8px;
      background: linear-gradient(45deg, #f59e0b, #eab308);
      clip-path: polygon(50% 0%, 0% 50%, 50% 100%, 100% 50%);
      animation: diamondPulse 2s ease-in-out infinite;
    }

    @keyframes diamondPulse {
      0%, 100% { opacity: 0.8; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.2); }
    }

    /* Enhanced CLI Styles */
    .cli-enhanced {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      border: 2px solid rgba(124, 58, 237, 0.4);
    }
    
    /* Side-by-Side Development View */
    .split-view {
      display: flex;
      width: 100%;
      height: 100%;
    }
    
    .code-editor-panel {
      flex: 1;
      height: 100%;
      background: #1a1a2e;
      border-right: 1px solid rgba(124, 58, 237, 0.3);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    .preview-panel {
      flex: 1;
      height: 100%;
      background: #ffffff;
      position: relative;
      overflow: auto;
    }
    
    .code-tabs {
      display: flex;
      background: rgba(0, 0, 0, 0.2);
      border-bottom: 1px solid rgba(124, 58, 237, 0.3);
    }
    
    .code-tab {
      padding: 8px 16px;
      font-size: 11px;
      background: transparent;
      color: #aaa;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .code-tab.active {
      background: rgba(124, 58, 237, 0.1);
      color: #fff;
      border-bottom: 2px solid #a855f7;
    }
    
    .code-tab:hover:not(.active) {
      background: rgba(124, 58, 237, 0.05);
      color: #ccc;
    }
    
    .code-content {
      flex: 1;
      padding: 10px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 12px;
      color: #e6e6e6;
      overflow: auto;
      background: #0d0d0d;
      position: relative;
    }
    
    .code-content pre {
      margin: 0;
      white-space: pre-wrap;
    }
    
    .prompt-container {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      backdrop-filter: blur(8px);
    }
    
    .prompt-box {
      width: 85%;
      max-width: 500px;
      background: #1a1a2e;
      border: 2px solid rgba(124, 58, 237, 0.5);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
    }
    
    .prompt-title {
      font-size: 16px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .prompt-options {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
    }
    
    .prompt-option {
      flex: 1 0 calc(50% - 10px);
      min-width: 200px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(124, 58, 237, 0.3);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .prompt-option:hover {
      background: rgba(124, 58, 237, 0.1);
      border-color: rgba(124, 58, 237, 0.5);
      transform: translateY(-2px);
    }
    
    .option-title {
      font-size: 14px;
      font-weight: 600;
      color: #a855f7;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .option-description {
      font-size: 11px;
      color: #aaa;
      line-height: 1.4;
    }
    
    .option-recommendation {
      margin-top: 8px;
      font-size: 10px;
      color: #10b981;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .prompt-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 20px;
    }
    
    .prompt-button {
      padding: 8px 16px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .prompt-button.primary {
      background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
      color: white;
      border: none;
    }
    
    .prompt-button.secondary {
      background: transparent;
      color: #aaa;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .prompt-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }
    
    .view-toggle {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 50;
      display: flex;
      gap: 5px;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      padding: 5px;
      border-radius: 20px;
    }
    
    .view-toggle-btn {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      color: #aaa;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 12px;
    }
    
    .view-toggle-btn.active {
      background: #a855f7;
      color: white;
    }
    
    .view-toggle-btn:hover:not(.active) {
      background: rgba(124, 58, 237, 0.2);
      color: #fff;
    }

    .diamond-quick-commands {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
      margin-bottom: 8px;
    }

    .diamond-quick-cmd {
      padding: 2px 6px;
      background: rgba(124, 58, 237, 0.1);
      border: 1px solid rgba(124, 58, 237, 0.3);
      border-radius: 12px;
      font-size: 8px;
      cursor: pointer;
      transition: all 0.2s;
      color: #a855f7;
    }

    .diamond-quick-cmd:hover {
      background: rgba(124, 58, 237, 0.2);
      border-color: rgba(124, 58, 237, 0.5);
      transform: scale(1.05);
    }

    /* Original ASOOS styles with Diamond enhancements */
    .enterprise-icon {
      width: 16px;
      height: 16px;
      display: inline-block;
      vertical-align: middle;
      fill: currentColor;
    }

    .enterprise-icon.large {
      width: 20px;
      height: 20px;
    }

    .enterprise-icon.xl {
      width: 24px;
      height: 24px;
    }

    .panel-icon {
      width: 14px;
      height: 14px;
      display: inline-block;
      vertical-align: middle;
      margin-right: 8px;
    }

    .integration-icon-svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
      display: inline-block;
    }

    .location-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      background: rgba(11, 177, 187, 0.1);
      border: 1px solid rgba(11, 177, 187, 0.3);
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      color: #0bb1bb;
    }

    .location-indicator.diamond-sao {
      background: rgba(255, 215, 0, 0.1);
      border-color: rgba(255, 215, 0, 0.3);
      color: #FFD700;
    }

    .location-indicator.admin {
      background: rgba(139, 92, 246, 0.1);
      border-color: rgba(139, 92, 246, 0.3);
      color: #8b5cf6;
    }

    /* Enhanced Animations for Diamond v99 */
    @keyframes float {
      0%, 100% { transform: translateY(0) translateX(0) rotate(0deg); }
      33% { transform: translateY(-15px) translateX(8px) rotate(8deg); }
      66% { transform: translateY(8px) translateX(-8px) rotate(-8deg); }
    }

    @keyframes glow {
      0%, 100% { box-shadow: 0 0 5px rgba(11, 177, 187, 0.8), 0 0 20px rgba(11, 177, 187, 0.4); }
      50% { box-shadow: 0 0 20px rgba(11, 177, 187, 1), 0 0 40px rgba(11, 177, 187, 0.6); }
    }

    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.08); opacity: 0.7; }
      100% { transform: scale(1); opacity: 1; }
    }

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    @keyframes slideOut {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(100%); opacity: 0; }
    }

    @keyframes breathe {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }

    @keyframes scan {
      0% { transform: translateY(0); opacity: 1; }
      50% { transform: translateY(-50%); opacity: 0.5; }
      100% { transform: translateY(-100%); opacity: 0; }
    }

    @keyframes enhancedFloat {
      0%, 100% { 
        transform: translateY(0) translateX(0) rotate(0deg) scale(1); 
        filter: blur(0px); 
        opacity: 0.6; 
      }
      25% { 
        transform: translateY(-20px) translateX(10px) rotate(90deg) scale(1.2); 
        filter: blur(1px); 
        opacity: 0.8; 
      }
      50% { 
        transform: translateY(-10px) translateX(-15px) rotate(180deg) scale(0.8); 
        filter: blur(2px); 
        opacity: 0.4; 
      }
      75% { 
        transform: translateY(15px) translateX(5px) rotate(270deg) scale(1.1); 
        filter: blur(1px); 
        opacity: 0.7; 
      }
    }

    /* Main Container */
    .main-container {
      display: flex;
      min-height: 100vh;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
      position: relative;
    }

    .page {
      display: none;
      width: 100%;
      min-height: 100vh;
    }

    .page.active {
      display: flex;
    }

    /* Enhanced Particles */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      pointer-events: none;
      z-index: -1;
    }

    .particle {
      position: absolute;
      border-radius: 50%;
      animation: enhancedFloat 12s infinite ease-in-out;
    }

    .particle:nth-child(3n) {
      width: 6px;
      height: 6px;
      background: radial-gradient(circle, rgba(11, 177, 187, 0.8), rgba(11, 177, 187, 0.2));
      animation-duration: 15s;
    }

    .particle:nth-child(3n+1) {
      width: 4px;
      height: 4px;
      background: radial-gradient(circle, rgba(80, 200, 120, 0.6), rgba(80, 200, 120, 0.1));
      animation-duration: 10s;
    }

    .particle:nth-child(3n+2) {
      width: 8px;
      height: 8px;
      background: radial-gradient(circle, rgba(255, 215, 0, 0.7), rgba(255, 215, 0, 0.2));
      animation-duration: 18s;
    }

    /* Sidebar */
    .sidebar {
      width: 48px;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(20px);
      border-right: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
      padding: 20px 4px;
      position: fixed;
      left: 0;
      top: 0;
      height: 100vh;
      z-index: 100;
    }

    .sidebar-icons {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      flex: 1;
      width: 100%;
    }

    .sidebar-icon {
      width: 24px;
      height: 24px;
      cursor: pointer;
      position: relative;
      transition: all 0.3s ease;
      z-index: 101;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .sidebar-icon:hover {
      transform: scale(1.15);
    }

    .sidebar-icon.active {
      animation: glow 2s infinite;
    }

    .sidebar-icon.settings-icon {
      margin-top: 30px;
    }

    .sidebar-icon.settings-icon:hover {
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.6) !important;
      background: rgba(255, 215, 0, 0.2) !important;
      border-radius: 50%;
    }

    .icon-tooltip {
      position: absolute;
      left: 54px;
      top: 50%;
      transform: translateY(-50%) translateX(-5px);
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(10px);
      padding: 8px 12px;
      border-radius: 6px;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s ease;
      border: 1px solid rgba(11, 177, 187, 0.5);
      font-size: 12px;
      z-index: 1000;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    }

    .sidebar-icon:hover .icon-tooltip {
      opacity: 1;
      transform: translateY(-50%) translateX(5px);
    }

    /* Header */
    .header {
      height: 40px;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      position: sticky;
      top: 0;
      z-index: 90;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 20px;
      padding-left: 40px;
    }

    .header-center {
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }

    .logo {
      font-size: 20px;
      font-weight: 900;
      background: linear-gradient(135deg, #FFD700, #c7b299, #50C878, #0bb1bb);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: 1px;
    }

    .user-info {
      padding-right: 40px;
    }

    .user-name {
      font-size: 14px;
      font-weight: 600;
      color: #ffffff;
    }

    .user-tagline {
      font-size: 13px;
      color: #0bb1bb;
      margin-top: 0px;
      margin-bottom: 0px;
      font-weight: 500;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      overflow-x: hidden;
      margin-left: 48px;
      width: calc(100% - 48px);
    }

    .content-area {
      flex: 1;
      display: flex;
      padding: 6px 15px 15px 15px;
      gap: 15px;
      overflow-y: auto;
      min-height: calc(100vh - 85px);
      position: relative;
    }

    /* Chat Area - Enhanced for Diamond CLI */
    .chat-area {
      flex: 1;
      min-width: 300px;
      display: flex;
      flex-direction: column;
      position: relative;
      transition: all 0.3s ease;
      height: calc(100vh - 120px);
      overflow: hidden;
    }

    .terminal-output {
      scrollbar-width: thin;
      scrollbar-color: #333 #0d0d0d;
    }

    /* Right Panel */
    .right-panel {
      width: 320px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      position: relative;
      height: calc(100vh - 120px);
      background: transparent;
      padding: 0 12px 12px 0;
      overflow-y: auto;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      flex-shrink: 0;
      border-left: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Panel components (keeping original styles) */
    .panel-card {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 12px;
      transition: all 0.3s;
      margin-bottom: 6px;
    }

    .panel-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(11, 177, 187, 0.2);
      border-color: rgba(11, 177, 187, 0.3);
    }

    .panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
      cursor: pointer;
      background: transparent;
      border: none;
      color: inherit;
      width: 100%;
      text-align: left;
    }

    .panel-title {
      font-size: 14px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .panel-content {
      display: none;
    }

    .panel-content.active {
      display: block;
      animation: slideIn 0.3s ease;
    }

    /* Copilot Section */
    .copilot-section {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 10px;
      margin-bottom: 6px;
      position: sticky;
      top: 0;
      z-index: 5;
    }

    .copilot-title {
      text-align: center;
      font-size: 16px;
      font-weight: 600;
      color: #0bb1bb;
      margin-bottom: 6px;
    }

    .copilot-hex-container {
      display: flex;
      gap: 6px;
      align-items: center;
      justify-content: center;
      padding: 6px 0;
      width: 100%;
    }

    .copilot-hex-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      transition: all 0.3s;
    }

    .copilot-hex-item:hover {
      transform: scale(1.1);
      animation: pulse 1.5s infinite;
    }

    .copilot-hex-item.active .copilot-status {
      opacity: 1;
      animation: pulse 2s infinite;
    }

    .copilot-name {
      font-size: 10px;
      color: #888;
      margin-top: 4px;
      font-weight: 500;
      transition: all 0.3s;
    }

    .copilot-name.active {
      color: #0bb1bb;
      font-weight: 600;
      text-shadow: 0 0 10px rgba(11, 177, 187, 0.5);
    }

    .copilot-status {
      position: absolute;
      bottom: -2px;
      right: -2px;
      width: 10px;
      height: 10px;
      background: #0bb1bb;
      border-radius: 50%;
      border: 2px solid #0a0a0a;
      opacity: 0;
      transition: all 0.3s;
      box-shadow: 0 0 10px rgba(11, 177, 187, 0.8);
    }

    /* Bottom Bar */
    .bottom-bar {
      height: 35px;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(20px);
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 15px;
      position: relative;
      z-index: 90;
    }

    .integration-icons {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 18px;
      flex: 1;
    }

    .integration-icon {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      border: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 18px;
      position: relative;
      backdrop-filter: blur(10px);
    }

    .integration-icon:hover {
      transform: scale(1.15) translateY(-3px);
      background: linear-gradient(135deg, rgba(11, 177, 187, 0.3), rgba(11, 177, 187, 0.1));
      border-color: #0bb1bb;
      box-shadow: 0 5px 15px rgba(11, 177, 187, 0.4);
    }

    .integration-icon.active {
      background: linear-gradient(135deg, rgba(11, 177, 187, 0.4), rgba(11, 177, 187, 0.2));
      border-color: #0bb1bb;
      box-shadow: 0 0 20px rgba(11, 177, 187, 0.5);
    }

    /* Notification */
    .notification {
      position: fixed;
      top: 80px;
      right: 20px;
      background: rgba(11, 177, 187, 0.95);
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      box-shadow: 0 4px 20px rgba(11, 177, 187, 0.4);
      animation: slideIn 0.3s ease;
      z-index: 1000;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(11, 177, 187, 0.3);
    }

    .notification.error {
      background: rgba(239, 68, 68, 0.95);
      border-color: rgba(239, 68, 68, 0.3);
    }

    .notification.success {
      background: rgba(16, 185, 129, 0.95);
      border-color: rgba(16, 185, 129, 0.3);
    }

    /* VisionSpeak PCP Natural Conversation Interface Styles */
    .visionspeak-pcp-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(15px);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.4s ease;
    }
    
    .visionspeak-pcp-container {
      width: 85%;
      max-width: 900px;
      height: 85%;
      background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
      border: 2px solid rgba(11, 177, 187, 0.4);
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 25px 80px rgba(0, 0, 0, 0.9);
      position: relative;
    }
    
    .visionspeak-pcp-header {
      padding: 25px;
      background: linear-gradient(135deg, #0bb1bb 0%, #4ECDC4 50%, #50C878 100%);
      color: white;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid rgba(11, 177, 187, 0.3);
      position: relative;
    }
    
    .pcp-identity {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .pcp-avatar {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      animation: pulse 2s ease-in-out infinite;
    }
    
    .pcp-info h2 {
      margin: 0;
      font-size: 28px;
      font-weight: 700;
      color: white;
    }
    
    .pcp-title {
      margin: 0;
      font-size: 14px;
      opacity: 0.9;
      color: rgba(255, 255, 255, 0.8);
    }
    
    .solutions-menu-header h2 {
      margin: 0;
      font-size: 24px;
      font-weight: 700;
    }
    
    .solutions-menu-header p {
      margin: 0;
      font-size: 14px;
      opacity: 0.9;
    }
    
    .visionspeak-close {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      position: absolute;
      right: 20px;
      top: 20px;
    }
    
    .visionspeak-close:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: scale(1.1);
    }
    
    .conversation-area {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background: rgba(0, 0, 0, 0.2);
    }
    
    .pcp-conversation-prompt {
      margin-bottom: 20px;
    }
    
    .conversation-bubble {
      background: rgba(11, 177, 187, 0.1);
      border: 1px solid rgba(11, 177, 187, 0.3);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 15px;
    }
    
    .pcp-bubble {
      background: linear-gradient(135deg, rgba(11, 177, 187, 0.1) 0%, rgba(80, 200, 120, 0.1) 100%);
      border-left: 4px solid #0bb1bb;
    }
    
    .user-bubble {
      background: linear-gradient(135deg, rgba(124, 58, 237, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%);
      border-left: 4px solid #7c3aed;
      margin-left: 60px;
    }
    
    .natural-examples {
      margin-top: 15px;
    }
    
    .natural-examples p {
      margin: 8px 0;
      font-size: 14px;
      color: #50C878;
      font-style: italic;
    }
    
    .pcp-listening-indicator {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 15px;
      padding: 10px;
      background: rgba(255, 215, 0, 0.1);
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-radius: 10px;
      color: #FFD700;
    }
    
    .listening-animation {
      width: 20px;
      height: 20px;
      background: linear-gradient(45deg, #FFD700, #FFA500);
      border-radius: 50%;
      animation: pulse 1.5s ease-in-out infinite;
    }
    
    .visionspeak-input-area {
      padding: 25px;
      background: rgba(0, 0, 0, 0.4);
      border-top: 1px solid rgba(11, 177, 187, 0.2);
    }
    
    .natural-input-container {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
    }
    
    .voice-activation-btn {
      background: linear-gradient(135deg, #0bb1bb 0%, #4ECDC4 100%);
      border: none;
      color: white;
      padding: 15px 20px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
      min-width: 160px;
      justify-content: center;
    }
    
    .voice-activation-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(11, 177, 187, 0.4);
    }
    
    .voice-activation-btn.active {
      background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
      animation: pulse 1s ease-in-out infinite;
    }
    
    .mic-icon {
      font-size: 18px;
    }
    
    .input-divider {
      color: #666;
      font-style: italic;
      font-size: 14px;
    }
    
    #naturalConversationInput {
      flex: 1;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(11, 177, 187, 0.3);
      border-radius: 12px;
      padding: 15px 18px;
      color: white;
      font-size: 16px;
      outline: none;
      transition: all 0.3s;
    }
    
    #naturalConversationInput:focus {
      border-color: rgba(11, 177, 187, 0.6);
      background: rgba(255, 255, 255, 0.15);
      box-shadow: 0 0 15px rgba(11, 177, 187, 0.2);
    }
    
    .send-natural-btn {
      background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
      border: none;
      color: white;
      padding: 15px 20px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s;
      min-width: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .send-natural-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(124, 58, 237, 0.4);
    }
    
    .conversation-actions {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .quick-action-btn, .collab-btn, .recent-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .quick-action-btn:hover, .collab-btn:hover, .recent-btn:hover {
      background: rgba(11, 177, 187, 0.2);
      border-color: rgba(11, 177, 187, 0.4);
      transform: translateY(-1px);
    }
    
    .solutions-menu-search {
      padding: 15px 20px;
      background: rgba(0, 0, 0, 0.3);
      display: flex;
      gap: 10px;
      align-items: center;
    }
    
    .solutions-menu-search input {
      flex: 1;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(124, 58, 237, 0.3);
      border-radius: 8px;
      padding: 12px 15px;
      color: white;
      font-size: 14px;
      outline: none;
    }
    
    .solutions-menu-search input:focus {
      border-color: rgba(124, 58, 237, 0.6);
      background: rgba(255, 255, 255, 0.15);
    }
    
    .voice-search-btn {
      background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
      border: none;
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s;
    }
    
    .voice-search-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(124, 58, 237, 0.4);
    }
    
    .solutions-menu-content {
      flex: 1;
      display: flex;
      overflow: hidden;
    }
    
    .solutions-categories {
      width: 300px;
      background: rgba(0, 0, 0, 0.2);
      border-right: 1px solid rgba(124, 58, 237, 0.2);
      overflow-y: auto;
      padding: 15px;
    }
    
    .solution-category {
      padding: 12px;
      margin-bottom: 8px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(124, 58, 237, 0.2);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .solution-category:hover {
      background: rgba(124, 58, 237, 0.2);
      border-color: rgba(124, 58, 237, 0.5);
      transform: translateY(-1px);
    }
    
    .solution-category.active {
      background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
      color: white;
    }
    
    .category-icon {
      font-size: 18px;
    }
    
    .category-info {
      flex: 1;
    }
    
    .category-name {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 2px;
    }
    
    .category-count {
      font-size: 12px;
      opacity: 0.7;
    }
    
    .solutions-list {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
    }
    
    .solution-item {
      padding: 15px;
      margin-bottom: 10px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(124, 58, 237, 0.2);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .solution-item:hover {
      background: rgba(124, 58, 237, 0.1);
      border-color: rgba(124, 58, 237, 0.4);
      transform: translateY(-2px);
    }
    
    .solution-name {
      font-weight: 600;
      font-size: 16px;
      color: #a855f7;
      margin-bottom: 5px;
    }
    
    .solution-description {
      font-size: 14px;
      color: #ccc;
      margin-bottom: 8px;
      line-height: 1.4;
    }
    
    .solution-tags {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }
    
    .solution-tag {
      padding: 2px 8px;
      background: rgba(124, 58, 237, 0.2);
      border: 1px solid rgba(124, 58, 237, 0.3);
      border-radius: 12px;
      font-size: 11px;
      color: #a855f7;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
    
    /* Right Panel Auto-Close Behavior */
    .right-panel.hidden {
      transform: translateX(100%);
      opacity: 0;
      pointer-events: none;
    }
    
    .content-area.full-width {
      padding-right: 0;
    }
    
    .chat-area.expanded {
      margin-right: 0;
    }

    /* Mobile Breakpoints */
    @media (max-width: 768px) {
      .chat-area {
        display: none !important;
      }

      .content-area {
        flex-direction: column;
        padding: 15px;
        margin-right: 0;
      }

      .right-panel {
        position: relative;
        width: 100%;
        height: auto;
        border-left: none;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        transform: none !important;
        padding: 20px 15px;
      }

      .sidebar {
        width: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .main-content {
        margin-left: 44px;
        width: calc(100% - 44px);
      }
      
      .solutions-menu-container {
        width: 95%;
        height: 90%;
      }
      
      .solutions-menu-content {
        flex-direction: column;
      }
      
      .solutions-categories {
        width: 100%;
        max-height: 200px;
        border-right: none;
        border-bottom: 1px solid rgba(124, 58, 237, 0.2);
      }
    }
    
    /* PCP Guide System Styles */
    .pcp-guide-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      z-index: 1100;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.4s ease;
    }
    
    .pcp-guide-container {
      width: 90%;
      max-width: 1000px;
      height: 90%;
      background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
      border: 2px solid rgba(11, 177, 187, 0.4);
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 30px 100px rgba(0, 0, 0, 0.9);
    }
    
    .pcp-guide-header {
      padding: 25px;
      background: linear-gradient(135deg, #0bb1bb 0%, #4ECDC4 50%, #50C878 100%);
      color: white;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid rgba(11, 177, 187, 0.3);
      position: relative;
    }
    
    .pcp-guide-close {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      position: absolute;
      right: 20px;
      top: 20px;
    }
    
    .pcp-guide-close:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: scale(1.1);
    }
    
    .pcp-guide-content {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      background: rgba(0, 0, 0, 0.2);
    }
    
    .guide-welcome {
      margin-bottom: 25px;
    }
    
    .guide-sections {
      display: flex;
      flex-direction: column;
      gap: 25px;
    }
    
    .guide-section {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(11, 177, 187, 0.2);
      border-radius: 12px;
      padding: 20px;
    }
    
    .guide-section h4 {
      margin: 0 0 15px 0;
      color: #0bb1bb;
      font-size: 18px;
      font-weight: 600;
    }
    
    .capability-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
    }
    
    .capability-card {
      background: rgba(11, 177, 187, 0.1);
      border: 1px solid rgba(11, 177, 187, 0.3);
      border-radius: 10px;
      padding: 15px;
      display: flex;
      align-items: flex-start;
      gap: 12px;
      transition: all 0.3s;
    }
    
    .capability-card:hover {
      background: rgba(11, 177, 187, 0.2);
      transform: translateY(-2px);
    }
    
    .capability-icon {
      font-size: 24px;
      flex-shrink: 0;
    }
    
    .capability-info h5 {
      margin: 0 0 5px 0;
      color: #4ECDC4;
      font-weight: 600;
    }
    
    .capability-info p {
      margin: 0;
      color: #ccc;
      font-size: 14px;
      line-height: 1.4;
    }
    
    .conversation-examples {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .conversation-example {
      background: rgba(80, 200, 120, 0.1);
      border: 1px solid rgba(80, 200, 120, 0.3);
      border-radius: 10px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .conversation-example:hover {
      background: rgba(80, 200, 120, 0.2);
      transform: translateX(5px);
    }
    
    .example-icon {
      font-size: 20px;
      color: #50C878;
    }
    
    .example-text strong {
      color: #50C878;
      display: block;
      margin-bottom: 3px;
    }
    
    .example-text small {
      color: #aaa;
      font-size: 12px;
    }
    
    .workflow-steps {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .workflow-step {
      background: rgba(124, 58, 237, 0.1);
      border: 1px solid rgba(124, 58, 237, 0.3);
      border-radius: 10px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: flex-start;
      gap: 15px;
    }
    
    .workflow-step:hover {
      background: rgba(124, 58, 237, 0.2);
      transform: translateY(-2px);
    }
    
    .step-number {
      background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      flex-shrink: 0;
    }
    
    .step-content {
      flex: 1;
    }
    
    .step-content h5 {
      margin: 0 0 8px 0;
      color: #a855f7;
      font-weight: 600;
    }
    
    .step-content p {
      margin: 0 0 10px 0;
      color: #ccc;
      font-size: 14px;
      line-height: 1.4;
    }
    
    .step-pcp-says {
      background: rgba(255, 215, 0, 0.1);
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-radius: 8px;
      padding: 10px;
      font-size: 13px;
      color: #FFD700;
    }
    
    .step-action {
      flex-shrink: 0;
    }
    
    .step-btn {
      background: linear-gradient(135deg, #0bb1bb 0%, #4ECDC4 100%);
      border: none;
      color: white;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
    }
    
    .step-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(11, 177, 187, 0.4);
    }
    
    .pcp-tips {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .pcp-tip {
      background: rgba(255, 215, 0, 0.1);
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-radius: 10px;
      padding: 15px;
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }
    
    .tip-icon {
      font-size: 20px;
      color: #FFD700;
      flex-shrink: 0;
    }
    
    .tip-content strong {
      color: #FFD700;
      display: block;
      margin-bottom: 5px;
    }
    
    .tip-content p {
      margin: 0;
      color: #ccc;
      font-size: 14px;
      line-height: 1.4;
    }
    
    .pcp-guide-actions {
      padding: 25px;
      background: rgba(0, 0, 0, 0.4);
      border-top: 1px solid rgba(11, 177, 187, 0.2);
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .primary-action-btn {
      background: linear-gradient(135deg, #0bb1bb 0%, #4ECDC4 100%);
      border: none;
      color: white;
      padding: 15px 25px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .secondary-action-btn {
      background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
      border: none;
      color: white;
      padding: 15px 25px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .tertiary-action-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: white;
      padding: 15px 25px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .primary-action-btn:hover, .secondary-action-btn:hover, .tertiary-action-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }
    
    /* Tool Blending Interface */
    .tool-blend-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      z-index: 1200;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.4s ease;
    }
    
    .blend-container {
      width: 85%;
      max-width: 800px;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      border: 2px solid rgba(255, 215, 0, 0.4);
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 30px 100px rgba(0, 0, 0, 0.9);
    }
    
    .blend-header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .blend-header h2 {
      color: #FFD700;
      margin: 0 0 10px 0;
      font-size: 28px;
    }
    
    .blend-input {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(11, 177, 187, 0.3);
      border-radius: 15px;
      padding: 20px;
      color: white;
      font-size: 16px;
      width: 100%;
      outline: none;
      resize: vertical;
      min-height: 120px;
      margin-bottom: 20px;
    }
    
    .blend-suggestions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-bottom: 25px;
    }
    
    .suggestion-card {
      background: rgba(11, 177, 187, 0.1);
      border: 1px solid rgba(11, 177, 187, 0.3);
      border-radius: 12px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .suggestion-card:hover {
      background: rgba(11, 177, 187, 0.2);
      transform: translateY(-2px);
    }
  </style>
  <!-- Load Diamond Solutions Menu -->
  <script src="../../../diamond-cli/lib/diamondSolutionsMenu.js"></script>
</head>
<body>
  <div class="main-container">
    <!-- Enhanced Particles Background -->
    <div class="particles" id="particles"></div>

    <!-- Enterprise Icon Library - SVG Definitions -->
    <svg style="display: none;">
      <defs>
        <!-- Enhanced Diamond CLI Icons -->
        <symbol id="icon-diamond" viewBox="0 0 24 24">
          <path d="M6 3h12l4 6-10 12L2 9l4-6z"/>
        </symbol>
        
        <symbol id="icon-cli" viewBox="0 0 24 24">
          <path d="M20 4H4c-1.11 0-2 .89-2 2v12c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4V8h16v10z"/>
          <path d="M7 13h2v-2H7v2zm4 0h6v-2h-6v2z"/>
        </symbol>

        <symbol id="icon-lock" viewBox="0 0 24 24">
          <path d="M6 10h2V8c0-2.21 1.79-4 4-4s4 1.79 4 4v2h2c1.1 0 2 .9 2 2v8c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2v-8c0-1.1.9-2 2-2zm6-6c-1.1 0-2 .9-2 2v2h4V6c0-1.1-.9-2-2-2z"/>
        </symbol>
        
        <symbol id="icon-unlock" viewBox="0 0 24 24">
          <path d="M18 10H9V8c0-1.1.9-2 2-2s2 .9 2 2h2c0-2.21-1.79-4-4-4S7 5.79 7 8v2H6c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8c0-1.1-.89-2-2-2z"/>
        </symbol>
        
        <symbol id="icon-bars" viewBox="0 0 24 24">
          <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
        </symbol>
        
        <symbol id="icon-chevron-down" viewBox="0 0 24 24">
          <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
        </symbol>
        
        <symbol id="icon-fire" viewBox="0 0 24 24">
          <path d="M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"/>
        </symbol>
        
        <symbol id="icon-lightbulb" viewBox="0 0 24 24">
          <path d="M12 2C8.13 2 5 5.13 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.87-3.13-7-7-7z"/>
        </symbol>
        
        <symbol id="icon-tasks" viewBox="0 0 24 24">
          <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6z"/>
        </symbol>
        
        <symbol id="icon-chart-line" viewBox="0 0 24 24">
          <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/>
        </symbol>
        
        <symbol id="icon-terminal" viewBox="0 0 24 24">
          <path d="M20 4H4c-1.11 0-2 .89-2 2v12c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4V8h16v10z"/>
          <path d="M7 13h2v-2H7v2zm4 0h6v-2h-6v2z"/>
        </symbol>
        
        <symbol id="icon-comments" viewBox="0 0 24 24">
          <path d="M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1zm-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h11c.55 0 1-.45 1-1z"/>
        </symbol>
        
        <symbol id="icon-microphone" viewBox="0 0 24 24">
          <path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"/>
        </symbol>

        <symbol id="icon-cog" viewBox="0 0 24 24">
          <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.***********61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.***********42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66Z"/>
        </symbol>

        <symbol id="icon-times" viewBox="0 0 24 24">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </symbol>

        <symbol id="icon-code" viewBox="0 0 24 24">
          <path d="M8 3a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H8zm1 2h6v14H9V5zm2 2v2h2V7h-2zm0 4v2h2v-2h-2z"/>
          <path d="M9.5 6.5l-3 3 3 3M14.5 6.5l3 3-3 3"/>
        </symbol>

        <symbol id="icon-bolt" viewBox="0 0 24 24">
          <path d="M11 21h-1l1-7H7.5c-.88 0-.33-.75-.31-.78C8.48 10.94 10.42 7.54 13.01 3h1.5l-1.01 7H17c.69 0 .52.75.48.78C16.19 13.08 14.13 16.3 11 21z"/>
        </symbol>

        <symbol id="icon-keyboard" viewBox="0 0 24 24">
          <path d="M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2z"/>
        </symbol>

        <!-- Integration Icons -->
        <symbol id="icon-google" viewBox="0 0 24 24">
          <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
          <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
        </symbol>

        <symbol id="icon-microsoft" viewBox="0 0 24 24">
          <path d="M11.4 24H0V12.6h11.4V24zM24 24H12.6V12.6H24V24zM11.4 11.4H0V0h11.4v11.4zM24 11.4H12.6V0H24v11.4z"/>
        </symbol>

        <symbol id="icon-slack" viewBox="0 0 24 24">
          <path d="M5.042 15.165a2.528 2.528 0 0 1-2.52 2.523A2.528 2.528 0 0 1 0 15.165a2.527 2.527 0 0 1 2.522-2.52h2.52v2.52z"/>
        </symbol>

        <symbol id="icon-github" viewBox="0 0 24 24">
          <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0 1 12 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77 1.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"/>
        </symbol>

        <symbol id="icon-linkedin" viewBox="0 0 24 24">
          <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286z"/>
        </symbol>

        <symbol id="icon-video" viewBox="0 0 24 24">
          <path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
        </symbol>

        <symbol id="icon-plus" viewBox="0 0 24 24">
          <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
        </symbol>
        
        <symbol id="icon-vision" viewBox="0 0 24 24">
          <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
        </symbol>
        
        <symbol id="icon-voice" viewBox="0 0 24 24">
          <path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"/>
          <path d="M3 9v6h4l5 5V4L7 9H3z"/>
        </symbol>
        
        <symbol id="icon-streaming" viewBox="0 0 24 24">
          <path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
          <circle cx="8" cy="12" r="2" fill="#ff4444"/>
          <path d="M20 4h-4V2h4v2zm0 16h-4v-2h4v2zm0-8h-4v-2h4v2z" fill="#ff4444"/>
        </symbol>
        
        <symbol id="icon-patent" viewBox="0 0 24 24">
          <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
          <path d="M8 12v2h8v-2H8zm0 3v2h5v-2H8z"/>
          <circle cx="15" cy="6" r="2" fill="#ffd700"/>
        </symbol>
      </defs>
    </svg>

    <!-- Main Page -->
    <div id="mainPage" class="page active">
      <!-- Sidebar with Squadron Icons -->
      <div class="sidebar">
        <div class="sidebar-icons">
          <div class="sidebar-icon active" onclick="selectIcon(this, 'Communication', '01')">
            <svg viewBox="0 0 24 24" fill="none" stroke="#FFD700" stroke-width="1.8">
              <circle cx="12" cy="12" r="10" fill="none" />
              <path d="M9 11l2 2 4-4" stroke="white" stroke-width="1.5" fill="none"/>
            </svg>
            <div class="icon-tooltip">
              <strong>Communication</strong><br>
              <small>Diamond SAO Conversational CLI</small>
            </div>
          </div>
          
          <div class="sidebar-icon" onclick="selectIcon(this, 'Growth', '02')">
            <svg viewBox="0 0 24 24" fill="none" stroke="#4ECDC4" stroke-width="1.8">
              <circle cx="12" cy="12" r="10" />
              <path d="M12 8v4l3 3" stroke="white" stroke-width="1.5"/>
            </svg>
            <div class="icon-tooltip">
              <strong>Growth</strong><br>
              <small>Growth Revenues</small>
            </div>
          </div>
          
          
          <div class="sidebar-icon" onclick="selectIcon(this, 'Voice', '04')">
            <svg viewBox="0 0 24 24" fill="none" stroke="#FF6B6B" stroke-width="1.8">
              <use href="#icon-voice" fill="none" stroke="#FF6B6B"/>
            </svg>
            <div class="icon-tooltip">
              <strong>Voice Synthesis</strong><br>
              <small>AI-Powered Voice Solutions</small>
            </div>
          </div>
          
          <div class="sidebar-icon" onclick="openVideoProductionStudio()">
            <svg viewBox="0 0 24 24" fill="none" stroke="#00D2FF" stroke-width="1.8">
              <use href="#icon-streaming" fill="none" stroke="#00D2FF"/>
            </svg>
            <div class="icon-tooltip">
              <strong>Video Production</strong><br>
              <small>Streaming, Webinars & Live Content</small>
            </div>
          </div>
            
            <!-- Side-by-Side Development View (Hidden by default) -->
            <div id="splitView" class="split-view" style="display: none;">
              <div class="code-editor-panel">
                <div class="code-tabs">
                  <button class="code-tab active" onclick="switchCodeTab(this, 'htmlCode')">HTML</button>
                  <button class="code-tab" onclick="switchCodeTab(this, 'cssCode')">CSS</button>
                  <button class="code-tab" onclick="switchCodeTab(this, 'jsCode')">JavaScript</button>
                </div>
                <div class="code-content" id="htmlCode">
                  <pre contenteditable="true">&lt;!-- Edit your HTML here --&gt;
&lt;div class="container"&gt;
  &lt;h1&gt;Welcome to Diamond Web Development&lt;/h1&gt;
  &lt;p&gt;This is a real-time preview of your web page.&lt;/p&gt;
  &lt;div class="card"&gt;
    &lt;h2&gt;Featured Content&lt;/h2&gt;
    &lt;p&gt;Edit this content and see changes instantly!&lt;/p&gt;
    &lt;button class="cta-button"&gt;Learn More&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
                </div>
                <div class="code-content" id="cssCode" style="display: none;">
                  <pre contenteditable="true">/* Edit your CSS here */
body {
  font-family: 'Arial', sans-serif;
  line-height: 1.6;
  color: #333;
  background: #f5f5f5;
  margin: 0;
  padding: 20px;
}

.container {
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
}

h1 {
  color: #7c3aed;
  border-bottom: 2px solid #a855f7;
  padding-bottom: 10px;
}

.card {
  background: white;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  margin-top: 20px;
}

.cta-button {
  background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  font-weight: bold;
  margin-top: 15px;
  transition: transform 0.2s;
}

.cta-button:hover {
  transform: translateY(-2px);
}</pre>
                </div>
                <div class="code-content" id="jsCode" style="display: none;">
                  <pre contenteditable="true">// Edit your JavaScript here
document.addEventListener('DOMContentLoaded', function() {
  // Add event listener to the button
  const button = document.querySelector('.cta-button');
  if (button) {
    button.addEventListener('click', function() {
      alert('Button clicked! Add your action here.');
    });
  }
  
  console.log('Page loaded and JavaScript initialized!');
});</pre>
                </div>
              </div>
              <div class="preview-panel" id="previewPanel">
                <iframe id="previewFrame" style="width: 100%; height: 100%; border: none;"></iframe>
              </div>
              
              <!-- Security Prompt (initially hidden) -->
              <div class="prompt-container" id="securityPrompt" style="display: none;">
                <div class="prompt-box">
                  <div class="prompt-title">
                    <span style="font-size: 18px;"></span> Select Security Implementation
                  </div>
                  <div>
                    <p style="color: #ccc; font-size: 12px; margin-bottom: 15px;">Diamond SAO detected a request for enhanced security. Please select the security implementation that best fits your needs:</p>
                  </div>
                  <div class="prompt-options">
                    <div class="prompt-option" onclick="selectSecurityOption('oauth')">
                      <div class="option-title">
                        <span style="color: #3b82f6;"></span> OAuth 2.0 / OIDC
                      </div>
                      <div class="option-description">
                        Industry standard for authorization, providing secure delegated access.
                      </div>
                      <div class="option-recommendation">
                        <span></span> Recommended for banking applications
                      </div>
                    </div>
                    <div class="prompt-option" onclick="selectSecurityOption('jwt')">
                      <div class="option-title">
                        <span style="color: #f59e0b;"></span> JWT Authentication
                      </div>
                      <div class="option-description">
                        Secure token-based authentication for stateless applications.
                      </div>
                      <div class="option-recommendation">
                        <span></span> Good for API security
                      </div>
                    </div>
                    <div class="prompt-option" onclick="selectSecurityOption('mfa')">
                      <div class="option-title">
                        <span style="color: #10b981;"></span> Multi-Factor Auth
                      </div>
                      <div class="option-description">
                        Additional verification layer beyond passwords, using multiple factors.
                      </div>
                      <div class="option-recommendation">
                        <span></span> Recommended for financial transactions
                      </div>
                    </div>
                    <div class="prompt-option" onclick="selectSecurityOption('encryption')">
                      <div class="option-title">
                        <span style="color: #a855f7;"></span> End-to-End Encryption
                      </div>
                      <div class="option-description">
                        Data encrypted across all points of transmission and storage.
                      </div>
                      <div class="option-recommendation">
                        <span></span> Good for sensitive data
                      </div>
                    </div>
                  </div>
                  <div class="prompt-actions">
                    <button class="prompt-button secondary" onclick="closeSecurityPrompt()">Cancel</button>
                    <button class="prompt-button primary" onclick="applySecurityOption()">Apply Selected Option</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="sidebar-icon" onclick="selectIcon(this, 'Services', '03')">
            <svg viewBox="0 0 24 24" fill="none" stroke="#45B7D1" stroke-width="1.8">
              <circle cx="12" cy="12" r="10" />
              <path d="M8 12h8M12 8v8" stroke="white" stroke-width="1.5"/>
            </svg>
            <div class="icon-tooltip">
              <strong>Services</strong><br>
              <small>Client Services Innovation</small>
            </div>
          </div>
          
          <div class="sidebar-icon" onclick="selectIcon(this, 'Automation', '02')">
            <svg viewBox="0 0 24 24" fill="none" stroke="#96CEB4" stroke-width="1.8">
              <circle cx="12" cy="12" r="10" />
              <path d="M12 6v6l4 2" stroke="white" stroke-width="1.5"/>
            </svg>
            <div class="icon-tooltip">
              <strong>Automation</strong><br>
              <small>Organizational Automation</small>
            </div>
          </div>
          
          <!-- Settings Icon - Always Last -->
          <div class="sidebar-icon settings-icon" onclick="openSettings()">
            <svg viewBox="0 0 24 24" fill="none" stroke="url(#settingsGradient)" stroke-width="1.8">
              <defs>
                <linearGradient id="settingsGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" stop-color="#FFD700" />
                  <stop offset="100%" stop-color="#0bb1bb" />
                </linearGradient>
              </defs>
              <path d="M12 2l3 7 7 1-5 5 1 7-6-3-6 3 1-7-5-5 7-1z" fill="url(#settingsGradient)" fill-opacity="0.2" />
            </svg>
            <div class="icon-tooltip">
              <strong>Settings & Configuration</strong><br>
              <small>Diamond SAO Command Center</small>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Main Content -->
      <div class="main-content">
        <!-- Header -->
        <div class="header">
          <div class="header-left">
            <div class="logo" id="systemLogo">ASOOS</div>
            <div class="diamond-mode-indicator">
              <div class="diamond-icon-small"></div>
              <span>Diamond SAO v34</span>
            </div>
          </div>
          <div class="user-info">
            <div class="user-name" id="userName">Mr. Phillip Corey Roark, CEO</div>
            <div class="user-tagline" id="userTagline">Diamond SAO Unified Infrastructure CLI</div>
          </div>
        </div>

        <!-- Content Area -->
        <div class="content-area" id="contentArea">
          <!-- Enhanced Diamond CLI Communication Area -->
          <div class="chat-area cli-enhanced" id="chatArea">
            <!-- View Mode Toggle -->
            <div class="view-toggle">
              <button class="view-toggle-btn active" id="chatViewBtn" onclick="switchView('chat')" title="Chat View">
                
              </button>
              <button class="view-toggle-btn" id="splitViewBtn" onclick="switchView('split')" title="Side-by-Side Development View">
                
              </button>
              <button class="view-toggle-btn" id="previewViewBtn" onclick="switchView('preview')" title="Preview Only">
                
              </button>
            </div>
            <!-- Diamond CLI Welcome -->
            <div style="background: linear-gradient(135deg, rgba(124, 58, 237, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%); border: 2px solid rgba(124, 58, 237, 0.3); padding: 12px; border-radius: 10px; margin: 12px;">
              <div style="font-size: 12px; font-weight: 600; color: #a855f7; margin-bottom: 6px; display: flex; align-items: center; gap: 8px;">
                <svg class="enterprise-icon" style="fill: #FFD700;"><use href="#icon-diamond"></use></svg>
                Diamond SAO Universal Infrastructure CLI
              </div>
              <div style="color: #aaa; font-size: 10px; line-height: 1.4;">
                Replace all traditional CLI tools with natural language. Manage DNS, Cloudflare Workers, MongoDB, GCP Secrets, and App Deployment through conversational AI.
              </div>
            </div>

            <!-- Diamond Quick Commands -->
            <div class="diamond-quick-commands" style="padding: 0 12px;">
              <div class="diamond-quick-cmd" onclick="openVisionSpeakPCP()">
                 Speak to Your PCP
              </div>
              <div class="diamond-quick-cmd" onclick="openNaturalConversation()">
                 Natural Conversation Mode
              </div>
              <div class="diamond-quick-cmd" onclick="executeDiamondCommand('update mcp domain to point to integration gateway')">
                 Update MCP Domain
              </div>
              <div class="diamond-quick-cmd" onclick="executeDiamondCommand('deploy integration gateway worker')">
                 Deploy Worker
              </div>
              <div class="diamond-quick-cmd" onclick="executeDiamondCommand('create database for user profiles')">
                 Create Database
              </div>
              <div class="diamond-quick-cmd" onclick="executeDiamondCommand('get api key secret from production')">
                 Get Secret
              </div>
            </div>
            
            <!-- VisionSpeak PCP Natural Conversation Interface -->
            <div id="visionSpeakPCPOverlay" class="visionspeak-pcp-overlay" style="display: none;">
              <div class="visionspeak-pcp-container">
                <div class="visionspeak-pcp-header">
                  <div class="pcp-identity">
                    <div class="pcp-avatar"></div>
                    <div class="pcp-info">
                      <h2 id="pcpName">Diamond SAO</h2>
                      <p class="pcp-title">Your Professional Co-Pilot</p>
                    </div>
                  </div>
                  <button class="visionspeak-close" onclick="closeVisionSpeakPCP()"></button>
                </div>
                
                <div class="conversation-area">
                  <div class="pcp-conversation-prompt">
                    <div class="conversation-bubble pcp-bubble">
                      <p><strong>Just speak naturally to your PCP:</strong></p>
                      <div class="natural-examples">
                        <p> "<em>Help me launch a new publishing campaign</em>"</p>
                        <p> "<em>Let's collaborate on setting up monitoring</em>"</p>
                        <p> "<em>I think we should deploy the integration gateway</em>"</p>
                        <p> "<em>Let's review our security configurations</em>"</p>
                        <p> "<em>Take me to the database management section</em>"</p>
                        <p> "<em>Let's finalize the voice synthesis setup</em>"</p>
                      </div>
                      <div class="pcp-listening-indicator" id="pcpListeningIndicator" style="display: none;">
                        <div class="listening-animation"></div>
                        <span>I'm listening...</span>
                      </div>
                    </div>
                  </div>
                  
                  <div class="conversation-history" id="conversationHistory">
                    <!-- Conversation will be populated here -->
                  </div>
                </div>
                
                <div class="visionspeak-input-area">
                  <div class="natural-input-container">
                    <button class="voice-activation-btn" onclick="startNaturalVoiceCapture()" id="voiceActivationBtn">
                      <div class="mic-icon"></div>
                      <span>Speak Naturally</span>
                    </button>
                    <div class="input-divider">or</div>
                    <input type="text" id="naturalConversationInput" placeholder="Type naturally: 'Help me with...', 'Let's work on...', 'I need to...'" onkeypress="handleNaturalInput(event)">
                    <button onclick="processNaturalInput()" class="send-natural-btn"></button>
                  </div>
                  
                  <div class="conversation-actions">
                    <button onclick="showQuickActions()" class="quick-action-btn"> Quick Actions</button>
                    <button onclick="showCollaborationMode()" class="collab-btn"> Collaboration Mode</button>
                    <button onclick="showRecentProjects()" class="recent-btn"> Recent Projects</button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Natural Language Chat with Diamond CLI -->
            <div id="naturalLanguageChat" style="flex: 1; display: flex; flex-direction: column;">
              <div style="flex: 1; overflow-y: auto; padding: 12px;">
                <div id="copilotMessages" style="display: flex; flex-direction: column; gap: 8px;">
                  <!-- Initial Diamond CLI Welcome -->
                  <div style="background: rgba(124, 58, 237, 0.1); border: 1px solid rgba(124, 58, 237, 0.3); padding: 12px; border-radius: 8px; align-self: flex-start; max-width: 85%;">
                    <div style="color: #a855f7; font-weight: 600; font-size: 11px; margin-bottom: 4px;"> Diamond SAO CLI v34</div>
                    <div style="color: #ccc; font-size: 10px; line-height: 1.4;">
                      Hi! I've replaced all your CLI tools with natural language processing:
                      <br><br>
                       DNS Operations (replaces gcloud CLI)<br>
                       Cloudflare Workers (replaces Wrangler CLI)<br>
                       MongoDB Operations (replaces mongo CLI)<br>
                       GCP Secrets (replaces gcloud secrets CLI)<br>
                       App Deployment (replaces Warp Drive CLI)<br>
                      <br>
                      Just tell me what you need in natural language!
                    </div>
                  </div>
                </div>
              </div>
              
              <div style="padding: 12px; border-top: 1px solid rgba(124, 58, 237, 0.2);">
                <div style="display: flex; gap: 6px; align-items: center;">
                  <!-- Diamond Mode Toggle -->
                  <button id="diamondModeToggleBtn" onclick="toggleDiamondMode()" style="background: rgba(255, 215, 0, 0.2); border: 1px solid rgba(255, 215, 0, 0.4); color: #FFD700; padding: 4px 8px; border-radius: 8px; font-size: 9px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 3px;" title="Diamond CLI Mode Active">
                    <svg class="enterprise-icon" style="width: 10px; height: 10px; fill: #FFD700;">
                      <use href="#icon-diamond"></use>
                    </svg>
                    DIAMOND
                  </button>
                  
                  <!-- Testing/Production Mode Toggle -->
                  <button id="modeToggleBtn" onclick="toggleMode()" style="background: rgba(245, 158, 11, 0.2); border: 1px solid rgba(245, 158, 11, 0.4); color: #f59e0b; padding: 4px 8px; border-radius: 8px; font-size: 9px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 3px;" title="Currently in Testing Mode - Click to switch">
                    <span id="modeIcon"></span>
                    <span id="modeText">TESTING</span>
                  </button>
                  
                  <!-- Local/Cloud Environment Toggle -->
                  <button id="envToggleBtn" onclick="toggleEnvironment()" style="background: rgba(16, 185, 129, 0.2); border: 1px solid rgba(16, 185, 129, 0.4); color: #10b981; padding: 4px 8px; border-radius: 8px; font-size: 9px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 3px;" title="Currently in Local Mode - Click to switch">
                    <span id="envIcon"></span>
                    <span id="envText">LOCAL</span>
                  </button>
                  
                  <!-- Image Upload Button -->
                  <button onclick="openImageHandler()" style="background: rgba(168, 85, 247, 0.2); border: 1px solid rgba(168, 85, 247, 0.4); color: #a855f7; width: 28px; height: 28px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s; font-size: 10px;" title="Add Images to Project">
                    
                  </button>
                  
                  <!-- Hidden File Input for Images -->
                  <input type="file" id="imageFileInput" accept="image/*" multiple style="display: none;" onchange="handleImageUpload(event)">
                  
                  <input type="text" id="diamondCliInput" placeholder="Tell me what you need... (e.g., 'deploy worker', 'create database')" style="flex: 1; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(124, 58, 237, 0.2); padding: 8px 12px; border-radius: 15px; color: white; font-size: 12px; outline: none;" onkeypress="handleDiamondKeyPress(event)">
                  
                  <button onclick="sendDiamondCommand()" style="background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); border: none; color: #ffffff; padding: 8px 12px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s; font-size: 11px;">
                     Execute
                  </button>
                  
                  <button onclick="startVoiceInput()" style="background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); color: white; width: 28px; height: 28px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s; font-size: 10px;">
                    <svg class="enterprise-icon" style="width: 10px; height: 10px; fill: #ffffff;">
                      <use href="#icon-microphone"></use>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
            
            <!-- Original AIXTIV CLI (Hidden by default, can be toggled) -->
            <div id="cliInterface" style="display: none; flex: 1; flex-direction: column; background: #0a0a0a; border: 1px solid #333;">
              <!-- CLI Interface content remains the same as original -->
              <div style="background: #1a1a1a; padding: 6px 10px; border-bottom: 1px solid #333; display: flex; align-items: center; justify-content: space-between;">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <span style="color: #0bb1bb; font-family: monospace; font-size: 11px; font-weight: 600;">AIXTIV CLI</span>
                  <span style="color: #666; font-size: 9px; font-family: monospace;">v2.1.0</span>
                </div>
                <div style="display: flex; gap: 4px; align-items: center;">
                  <button style="background: #2a2a2a; border: 1px solid #444; color: #0bb1bb; cursor: pointer; padding: 2px 4px; border-radius: 3px; font-size: 8px;" onclick="openAPIConfig()" title="Configure API">
                    <svg class="enterprise-icon" style="width: 8px; height: 8px;"><use href="#icon-cog"></use></svg> API Config
                  </button>
                </div>
              </div>
              
              <div class="terminal-output" id="terminalOutput" style="flex: 1; overflow-y: auto; padding: 10px; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 11px; line-height: 1.4; color: #e6e6e6; background: #0d0d0d; display: block;">
                <div class="terminal-line">
                  <span style="color: #50C878;">asoos@diamond</span><span style="color: #0bb1bb;">:</span><span style="color: #4ECDC4;">~</span><span style="color: #e6e6e6;">$ </span><span style="color: #fff;">_</span>
                </div>
              </div>
              
              <div class="cli-input-area" style="border-top: 1px solid #333; background: #1a1a1a; padding: 6px; display: flex; align-items: center; gap: 6px;">
                <span style="color: #50C878; font-family: monospace; font-size: 11px;">$</span>
                
                <button id="cliModeToggleBtn" onclick="toggleDiamondMode()" style="background: rgba(124, 58, 237, 0.2); border: 1px solid rgba(124, 58, 237, 0.4); color: #a855f7; padding: 2px 6px; border-radius: 6px; font-size: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 2px;" title="Switch to Diamond Mode">
                  <svg class="enterprise-icon" style="width: 8px; height: 8px; fill: #a855f7;">
                    <use href="#icon-diamond"></use>
                  </svg>
                  DIAMOND
                </button>
                
                <input type="text" class="cli-input" id="cliInput" placeholder="Enter command..." style="flex: 1; background: transparent; border: none; outline: none; color: #fff; font-family: 'Monaco', 'Menlo', monospace; font-size: 11px;" onkeypress="handleCLIKeyPress(event)">
                
                <button id="executeBtn" class="cli-btn" onclick="executeCLICommand()" style="background: #0bb1bb; border: none; color: #000; padding: 4px 8px; border-radius: 4px; font-family: monospace; font-size: 10px; cursor: pointer; font-weight: 600;">
                  EXECUTE
                </button>
              </div>
            </div>
          </div>
          
          <!-- Right Panel (keeping original functionality) -->
          <div class="right-panel" id="rightPanel">
            <!-- Copilot Section -->
            <div class="copilot-section">
              <div class="copilot-title">DIAMOND SAO COPILOTS</div>
              <div class="copilot-hex-container">
                <div class="copilot-hex-item active" onclick="activateRIX('QB', 'Diamond QB')">
                  <div class="copilot-hex">
                    <svg viewBox="0 0 60 60" style="width: 50px; height: 50px;">
                      <defs>
                        <linearGradient id="qbGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                          <stop offset="0%" style="stop-color:#FFD700;stop-opacity:1" />
                          <stop offset="100%" style="stop-color:#0bb1bb;stop-opacity:1" />
                        </linearGradient>
                      </defs>
                      <path d="M30 5 L50 20 L50 40 L30 55 L10 40 L10 20 Z" fill="url(#qbGradient)" stroke="#FFD700" stroke-width="2" opacity="0.9" />
                      <text x="30" y="26" text-anchor="middle" fill="white" font-size="12" font-weight="800"></text>
                      <text x="30" y="38" text-anchor="middle" fill="white" font-size="9" font-weight="600">SAO</text>
                    </svg>
                    <div class="copilot-status"></div>
                  </div>
                  <div class="copilot-name active">Diamond SAO</div>
                </div>
                
                <div class="copilot-hex-item" onclick="activateRIX('SH', 'Claude 4')">
                  <div class="copilot-hex">
                    <svg viewBox="0 0 60 60" style="width: 50px; height: 50px;">
                      <defs>
                        <linearGradient id="shGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                          <stop offset="0%" style="stop-color:#4ECDC4;stop-opacity:1" />
                          <stop offset="100%" style="stop-color:#FFD700;stop-opacity:1" />
                        </linearGradient>
                      </defs>
                      <path d="M30 5 L50 20 L50 40 L30 55 L10 40 L10 20 Z" fill="url(#shGradient)" stroke="#4ECDC4" stroke-width="2" opacity="0.9" />
                      <text x="30" y="26" text-anchor="middle" fill="white" font-size="12" font-weight="800">SH</text>
                      <text x="30" y="38" text-anchor="middle" fill="white" font-size="9" font-weight="600">RIX</text>
                    </svg>
                    <div class="copilot-status"></div>
                  </div>
                  <div class="copilot-name">Claude 4</div>
                </div>
                
                <div class="copilot-hex-item" onclick="activateRIX('Q', 'Q RIX')">
                  <div class="copilot-hex">
                    <svg viewBox="0 0 60 60" style="width: 50px; height: 50px;">
                      <defs>
                        <linearGradient id="qGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                          <stop offset="0%" style="stop-color:#50C878;stop-opacity:1" />
                          <stop offset="100%" style="stop-color:#c7b299;stop-opacity:1" />
                        </linearGradient>
                      </defs>
                      <path d="M30 5 L50 20 L50 40 L30 55 L10 40 L10 20 Z" fill="url(#qGradient)" stroke="#50C878" stroke-width="2" opacity="0.9" />
                      <text x="30" y="26" text-anchor="middle" fill="white" font-size="12" font-weight="800">Q</text>
                      <text x="30" y="38" text-anchor="middle" fill="white" font-size="9" font-weight="600">RIX</text>
                    </svg>
                    <div class="copilot-status"></div>
                  </div>
                  <div class="copilot-name">Q RIX</div>
                </div>
              </div>
            </div>

            <!-- Infrastructure Status Panel -->
            <div class="panel-card">
              <button class="panel-header" onclick="togglePanel(this)">
                <div class="panel-title">
                  <svg class="panel-icon" style="fill: #a855f7;">
                    <use href="#icon-chart-line"></use>
                  </svg>
                  Diamond SAO Infrastructure
                </div>
                <svg class="enterprise-icon chevron-icon" style="fill: rgba(255, 255, 255, 0.8); transition: all 0.3s ease;">
                  <use href="#icon-chevron-down"></use>
                </svg>
              </button>
              <div class="panel-content active">
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                  <span style="font-size: 10px; color: #ccc;">DNS Manager</span>
                  <span style="font-size: 10px; color: #10b981;"> Active</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                  <span style="font-size: 10px; color: #ccc;">Workers Manager</span>
                  <span style="font-size: 10px; color: #10b981;"> Active</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                  <span style="font-size: 10px; color: #ccc;">MongoDB Manager</span>
                  <span style="font-size: 10px; color: #10b981;"> Active</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                  <span style="font-size: 10px; color: #ccc;">Secrets Manager</span>
                  <span style="font-size: 10px; color: #10b981;"> Active</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                  <span style="font-size: 10px; color: #ccc;">Warp Drive Manager</span>
                  <span style="font-size: 10px; color: #10b981;"> Active</span>
                </div>
              </div>
            </div>

            <!-- Today's Hot Topics (keeping original) -->
            <div class="panel-card">
              <button class="panel-header" onclick="togglePanel(this)">
                <div class="panel-title">
                  <svg class="panel-icon" style="fill: #ff6b35;">
                    <use href="#icon-fire"></use>
                  </svg>
                  Today's Hot Topics
                </div>
                <svg class="enterprise-icon chevron-icon" style="fill: rgba(255, 255, 255, 0.8); transition: all 0.3s ease;">
                  <use href="#icon-chevron-down"></use>
                </svg>
              </button>
              <div class="panel-content active">
                <div style="padding: 6px; margin-bottom: 6px;">
                  <div style="font-size: 11px; font-weight: 600; color: #fff; margin-bottom: 2px;">Diamond SAO CLI Deployment Complete</div>
                  <div style="font-size: 9px; color: #aaa; line-height: 1.2;">All traditional CLI tools replaced with conversational AI</div>
                </div>
                <div style="padding: 6px;">
                  <div style="font-size: 11px; font-weight: 600; color: #fff; margin-bottom: 2px;">Infrastructure Automation +95%</div>
                  <div style="font-size: 9px; color: #aaa; line-height: 1.2;">Natural language processing active across all systems</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Enhanced Bottom Bar with Diamond Integration -->
        <div class="bottom-bar">
          <div class="integration-icons">
            <div class="integration-icon" title="Google Workspace" onclick="handleIntegrationClick('Google Workspace')">
              <svg class="integration-icon-svg" style="fill: #ffffff;">
                <use href="#icon-google"></use>
              </svg>
            </div>
            <div class="integration-icon" title="Microsoft 365" onclick="handleIntegrationClick('Microsoft 365')">
              <svg class="integration-icon-svg" style="fill: #ffffff;">
                <use href="#icon-microsoft"></use>
              </svg>
            </div>
            <div class="integration-icon" title="Slack" onclick="handleIntegrationClick('Slack')">
              <svg class="integration-icon-svg" style="fill: #ffffff;">
                <use href="#icon-slack"></use>
              </svg>
            </div>
            <div class="integration-icon" title="GitHub" onclick="handleIntegrationClick('GitHub')">
              <svg class="integration-icon-svg" style="fill: #ffffff;">
                <use href="#icon-github"></use>
              </svg>
            </div>
            <div class="integration-icon active" title="Diamond SAO Infrastructure CLI" onclick="showDiamondStatus()">
              <svg class="integration-icon-svg" style="fill: #FFD700;">
                <use href="#icon-diamond"></use>
              </svg>
            </div>
          </div>
          
          <div style="display: flex; align-items: center; gap: 8px;">
            <div class="diamond-mode-indicator" style="font-size: 10px;">
              <div class="diamond-icon-small"></div>
              <span>5 CLI Tools Replaced</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Diamond CLI Variables
    let isDiamondMode = true;
    let currentDiamondService = 'unified';
    let isProcessingDiamondCommand = false;
    let isProductionMode = false; // Default to Testing Mode
    let isCloudMode = false; // Default to Local Mode
    let rightPanelState = 'open'; // Track right panel state
    let solutionsMenuActive = false; // Track solutions menu state
    
    // Diamond Solutions Menu System
    let DiamondSolutionsMenu = null;
    let VisionSpeakHandler = null;
    
    // CI/CD & CI/CTT Configuration
    const MODES = {
      TESTING: {
        name: 'Testing',
        color: '#f59e0b',
        icon: '',
        description: 'Safe testing environment - no live changes'
      },
      PRODUCTION: {
        name: 'Production', 
        color: '#dc2626',
        icon: '',
        description: 'Live environment - real API calls and deployments'
      }
    };
    
    // Local/Cloud Environment Configuration
    const ENVIRONMENTS = {
      LOCAL: {
        name: 'Local',
        color: '#10b981',
        icon: '',
        description: 'Local development environment'
      },
      CLOUD: {
        name: 'Cloud',
        color: '#3b82f6', 
        icon: '',
        description: 'Cloud-based infrastructure'
      }
    };
    
    // Image handling state
    let imageAssets = [];
    let currentImageDirectory = '/Users/as/asoos/integration-gateway/assets/images';
    
    // Supported image formats
    const SUPPORTED_IMAGE_FORMATS = ['jpg', 'jpeg', 'png', 'gif', 'svg', 'webp', 'ico'];

    // CRX Super-Agent System (Not Chatbots - Super-Powered Agents)
    let activeCRX = {
      model: 'CRX01', // CRX01 (Enterprise), CRX02 (NGO), CRX03 (Government)
      capabilities: {
        strategicConsulting: '3x McKinsey/PWC/EY/Bain level',
        mlIntelligence: 'Dr. Lucy advanced ML',
        predictiveCapability: 'Victory 36 foresight',
        promptingMastery: 'Dream Commander expertise',
        orchestration: 'Dr. Claude coordination'
      },
      sectorSpecialization: determineCRXSpecialization(),
      authorityLevel: 'executive-advisor' // Can make strategic recommendations
    };
    
    // Q4D Cultural Empathy & ML Intelligence System
    let userQ4DProfile = {
      culturalEmpathy: 'adaptive',
      personalityType: 'analytical', // Will be determined by ML
      engagementPreferences: {
        visualComplexity: 'moderate',
        interactionStyle: 'guided',
        informationDensity: 'detailed',
        responseSpeed: 'thoughtful'
      },
      learnedBehaviors: []
    };
    
    // Organizational Intelligence & Functional Design System
    let organizationalContext = {
      company: {
        size: 'medium', // small (<100), medium (100-1000), large (1000-10K), enterprise (10K+)
        sector: 'technology', // finance, healthcare, manufacturing, etc.
        structure: 'matrix', // hierarchical, flat, matrix, hybrid
        complianceLevel: 'moderate' // minimal, moderate, high, critical
      },
      userRole: {
        function: 'accounting', // From functional design library
        level: 'manager', // assistant, specialist, manager, director, executive
        breadth: 'broad', // narrow (specialized), moderate, broad (generalist)
        depth: 'deep', // surface, moderate, deep (expert)
        decisionAuthority: 'moderate' // limited, moderate, high, autonomous
      },
      workflowComplexity: {
        approvalLayers: 2, // Number of approval levels typically needed
        integrationPoints: 8, // Systems/tools they work with
        complianceRequirements: ['SOX', 'GAAP'], // Specific compliance needs
        reportingFrequency: 'monthly', // daily, weekly, monthly, quarterly
        stakeholderCount: 15 // Number of people they regularly interact with
      }
    };
    
    let pilotCoordination = {
      activePilots: 20000 + Math.floor(Math.random() * 1000), // Base + dynamic allocation
      mlEngines: 47, // ML prediction engines running
      quantIntelligenceActive: true,
      culturalEmpathyMode: 'active',
      predictiveAccuracy: 94.7 // Current prediction accuracy %
    };
    
    // Corporate Tool Integration & Recommendation System
    let integrationSystem = {
      availableTools: 9000, // Pre-integrated corporate tools
      userActiveTools: [], // Tools currently used by this user
      detectedWorkflows: [], // ML-detected workflow patterns
      processOptimizations: [], // Identified improvement opportunities
      recommendationEngine: {
        processEfficiency: true,
        careerDevelopment: true,
        toolOptimization: true,
        workflowAutomation: true,
        timeReduction: true
      },
      automationOpportunities: {
        repetitiveTasks: [],
        dataEntry: [],
        reporting: [],
        approvals: [],
        notifications: []
      }
    };
    
    // Dynamic Gift Shop with GCP Auto-Provisioning
    let giftShopSystem = {
      staticProducts: [], // Pre-listed products in gift shop
      gcpIntegration: {
        autoProvisioningEnabled: true,
        costMarkup: 1.0, // 100% markup (cost + 100%)
        billingIntegration: 'xero',
        projectCreation: 'automatic',
        availableServices: 'all-gcp-products'
      },
      dynamicProvisioning: {
        detection: 'crx-powered', // CRX detects needs automatically
        approval: 'instant', // No delays for client solutions
        setup: 'automated', // Full GCP project setup
        billing: 'transparent' // Seamless monthly billing
      },
      xeroIntegration: {
        accountingSync: true,
        monthlyBilling: true,
        costTracking: true,
        revenueRecognition: 'automatic'
      }
    };
    
    // Per-Customer GCP Project Management System
    let customerGCPManagement = {
      autoProjectCreation: {
        onOnboarding: true,
        namingConvention: 'customer-{company-slug}-{date}',
        enabledServices: ['compute', 'storage', 'ai', 'data', 'security'],
        billingAccount: 'automated-linking',
        accessManagement: 'customer-isolated'
      },
      billingTracking: {
        realTimeMonitoring: true,
        monthlyAggregation: true,
        costAllocation: {
          licensing: 'base-subscription',
          gcpServices: 'usage-based',
          markup: '100-percent',
          support: 'included'
        },
        invoiceGeneration: {
          xeroIntegration: true,
          detailedBreakdown: true,
          serviceLineItems: true,
          customerFacingPricing: true, // Show final prices, not markup structure
          internalCostTracking: true // Track markup internally for accounting
        }
      },
      projectManagement: {
        isolation: 'complete', // Each customer has isolated resources
        monitoring: 'automated', // Automated cost and usage monitoring
        optimization: 'crx-powered', // CRX recommends optimizations
        compliance: 'built-in', // Automatic compliance tracking
        integrationValue: {
          preBuiltIntegrations: '9000-tools',
          setupCostSavings: '50k-500k-per-customer',
          implementationTime: 'instant-vs-months',
          expertConfiguration: 'included-free',
          ongoingMaintenance: 'automated-included'
        },
        dataSovereignty: {
          dataHosting: 'never-by-us', // We never host customer data
          storageOptions: {
            existing: 'connect-to-customer-infrastructure',
            dedicated: 'customer-owned-gcp-project',
            licensed: 'isolated-data-center-through-us'
          },
          configuration: {
            guidance: 'crx-provided',
            automation: 'available-on-request',
            security: 'enterprise-grade',
            compliance: 'customer-controlled'
          },
          ownership: 'complete-customer-control'
        }
      },
      dataOnboardingChoice: {
        question: 'Data Storage Preference',
        optionA: {
          title: 'Self-Managed Isolated Data Center',
          description: 'You configure and pay for your own secure data center. We help set it up, you own and control everything.',
          benefits: ['Complete control', 'Direct GCP billing', 'Custom configuration'],
          setup: 'crx-guided-configuration'
        },
        optionB: {
          title: 'Managed Custom Data Project', 
          description: 'We manage a completely custom data project for you. Your data, your schema, your dedicated project.',
          benefits: ['Professional management', 'Custom data schema', 'Full access to YOUR data'],
          setup: 'automated-with-customer-ownership'
        },
        commonBenefits: [
          'Zero data hosting by us',
          'Complete customer data ownership',
          'Enterprise-grade security',
          'Full isolation and compliance'
        ]
      }
    };
    
    // Initialize Diamond CLI with Q4D-aware system
    document.addEventListener('DOMContentLoaded', function() {
      initializeParticles();
      initializeDiamondSolutionsMenu();
      initializeQ4DSystem();
      initializePilotCoordination();
      startMLLearning();
      console.log(' Diamond SAO Universal CLI v34 Initialized');
      console.log(' Q4D Cultural Empathy System: Active');
      console.log(` Pilot Coordination: ${pilotCoordination.activePilots} pilots active`);
      console.log(' ML Predictive Intelligence: Learning from every interaction');
      console.log(' CRX Super-Agent: ' + activeCRX.model + ' Specialized for ' + activeCRX.sectorSpecialization);
      console.log(' Elite Capabilities: 3x Top-Tier Consulting + Advanced AI');
      console.log(' Corporate Tool Integration: 9,000 tools available for optimization');
      console.log(' Comprehensive Solutions Menu: 138 automated solutions loaded');
      
      // Initialize recommendation engine and customer GCP project
      setTimeout(generateInitialRecommendations, 2000);
      setTimeout(ensureCustomerGCPProject, 1000);
    });
    
    // Q4D & Organizational Intelligence Functions
    function initializeQ4DSystem() {
      // Analyze user's Q4D profile based on initial interactions
      console.log(' Q4D Cultural Empathy System initializing...');
      updatePilotInstructions();
    }
    
    function initializePilotCoordination() {
      // Coordinate the 20,000+ pilots based on organizational context
      const contextualPilots = calculateOptimalPilotAllocation();
      pilotCoordination.activePilots += contextualPilots;
      console.log(` ${pilotCoordination.activePilots} pilots coordinated for this session`);
    }
    
    function startMLLearning() {
      // Start ML engines to learn from every interaction
      setInterval(updatePredictiveModels, 5000); // Update every 5 seconds
      console.log(' ML Learning engines active - monitoring all interactions');
    }
    
    function calculateOptimalPilotAllocation() {
      // Calculate additional pilots needed based on organizational complexity
      let additionalPilots = 0;
      
      // Company size multiplier
      const sizeMultipliers = { small: 100, medium: 500, large: 1000, enterprise: 2000 };
      additionalPilots += sizeMultipliers[organizationalContext.company.size] || 500;
      
      // Role complexity multiplier  
      if (organizationalContext.userRole.breadth === 'broad') additionalPilots += 300;
      if (organizationalContext.userRole.depth === 'deep') additionalPilots += 200;
      
      // Workflow complexity
      additionalPilots += organizationalContext.workflowComplexity.integrationPoints * 25;
      additionalPilots += organizationalContext.workflowComplexity.stakeholderCount * 10;
      
      return additionalPilots;
    }
    
    function updatePilotInstructions() {
      // Send contextual instructions to pilots based on organizational context
      const instructions = generateContextualInstructions();
      console.log(' Pilot instructions updated for organizational context');
    }
    
    function generateContextualInstructions() {
      const context = organizationalContext;
      const instructions = {
        priorityFocus: determinePriorityFocus(context),
        workflowOptimization: determineWorkflowNeeds(context),
        complianceAwareness: context.workflowComplexity.complianceRequirements,
        stakeholderConsideration: context.workflowComplexity.stakeholderCount > 10 ? 'high' : 'moderate'
      };
      return instructions;
    }
    
    function determinePriorityFocus(context) {
      // Determine what pilots should prioritize based on role and company
      if (context.userRole.function === 'accounting') {
        if (context.company.size === 'small') {
          return 'broad-support'; // Solo accounting person needs versatile tools
        } else if (context.company.size === 'enterprise') {
          return 'compliance-precision'; // Enterprise needs strict compliance
        }
      }
      return 'balanced-optimization';
    }
    
    function determineWorkflowNeeds(context) {
      const needs = [];
      if (context.workflowComplexity.approvalLayers > 2) needs.push('approval-workflow');
      if (context.workflowComplexity.integrationPoints > 5) needs.push('system-integration');
      if (context.company.complianceLevel === 'critical') needs.push('audit-trails');
      return needs;
    }
    
    function updatePredictiveModels() {
      // Update ML models based on recent interactions
      pilotCoordination.predictiveAccuracy = Math.min(99.9, pilotCoordination.predictiveAccuracy + (Math.random() * 0.1 - 0.05));
      
      // Simulate pilot count fluctuations based on current activity
      const variance = Math.floor(Math.random() * 200 - 100);
      pilotCoordination.activePilots = Math.max(20000, pilotCoordination.activePilots + variance);
      
      // Update right panel with current pilot status
      updatePilotStatusDisplay();
    }
    
    function updatePilotStatusDisplay() {
      const pilotCountElement = document.getElementById('activePilotCount');
      if (pilotCountElement) {
        pilotCountElement.textContent = pilotCoordination.activePilots.toLocaleString();
      }
    }
    
    // Elite PCP Recommendation Engine (3x McKinsey/PWC/EY/Bain + AI)
    function generateInitialRecommendations() {
      console.log(' Elite PCP analyzing your role and generating strategic recommendations...');
      
      // Analyze current organizational context and generate recommendations
      const recommendations = analyzeAndRecommend();
      displayPCPRecommendations(recommendations);
    }
    
    function analyzeAndRecommend() {
      const context = organizationalContext;
      const recommendations = [];
      
      // Strategic Process Optimization (McKinsey-level)
      if (context.userRole.function === 'accounting' && context.company.size === 'enterprise') {
        recommendations.push({
          type: 'process_optimization',
          priority: 'high',
          title: 'Month-End Close Automation',
          description: 'I can reduce your month-end close from 8 days to 3 days by automating reconciliations across your existing SAP, Excel, and reporting tools.',
          impact: 'Save 120 hours monthly, reduce errors by 85%',
          effort: 'Medium - 2 week implementation',
          tools: ['SAP', 'Excel', 'Power BI', 'SharePoint'],
          consultant_level: 'Partner-level process re-engineering'
        });
      }
      
      // Career Development Recommendations (Strategic Advisory)
      recommendations.push({
        type: 'career_development',
        priority: 'medium',
        title: 'Strategic Finance Leadership Path',
        description: 'Based on your role trajectory and organizational needs, developing advanced data analytics and strategic planning skills will position you for VP Finance within 18 months.',
        impact: 'Clear promotion pathway, 40-60% salary increase potential',
        effort: 'Low - Learn while working with AI assistance',
        skills: ['Strategic Analytics', 'Executive Presentation', 'Cross-functional Leadership'],
        consultant_level: 'Executive coaching + organizational strategy'
      });
      
      // Tool Optimization (Efficiency Consulting)
      recommendations.push({
        type: 'tool_optimization', 
        priority: 'high',
        title: 'Unlock Hidden Productivity',
        description: 'You\'re using only 23% of your current software capabilities. I can help you leverage advanced features to work 3x faster.',
        impact: '15 hours weekly time savings, eliminate repetitive tasks',
        effort: 'Low - Guided learning with AI assistance',
        hidden_features: ['Excel Power Query', 'SAP Automation', 'Outlook Rules', 'Teams Integration'],
        consultant_level: 'Operations excellence optimization'
      });
      
      // Predictive Workflow Optimization (Victory 36 Intelligence)
      recommendations.push({
        type: 'predictive_workflow',
        priority: 'medium',
        title: 'Anticipatory Problem Solving',
        description: 'I predict 3 workflow bottlenecks that will emerge in Q2. Let me set up preventive automation now.',
        impact: 'Prevent future crises, maintain smooth operations',
        effort: 'Low - AI handles the heavy lifting',
        predictions: ['Vendor payment delays', 'Compliance reporting gaps', 'Resource allocation conflicts'],
        consultant_level: 'Strategic foresight + risk management'
      });
      
      return recommendations;
    }
    
    function displayPCPRecommendations(recommendations) {
      // Display recommendations in the right panel with consulting-grade presentation
      const rightPanel = document.getElementById('rightPanel');
      if (!rightPanel) return;
      
      let recommendationsHTML = `
        <div class="pcp-recommendations">
          <div class="recommendations-header">
            <h3> Elite PCP Strategic Recommendations</h3>
            <p class="consulting-badge">3x McKinsey  PWC  EY  Bain + Advanced AI</p>
          </div>
      `;
      
      recommendations.forEach((rec, index) => {
        const priorityColor = rec.priority === 'high' ? '#ff4444' : rec.priority === 'medium' ? '#ffaa00' : '#44ff44';
        recommendationsHTML += `
          <div class="recommendation-card" style="border-left: 4px solid ${priorityColor}">
            <div class="rec-header">
              <h4>${rec.title}</h4>
              <span class="priority-badge" style="background: ${priorityColor}">${rec.priority.toUpperCase()}</span>
            </div>
            <p class="rec-description">${rec.description}</p>
            <div class="rec-impact">
              <strong> Impact:</strong> ${rec.impact}
            </div>
            <div class="rec-effort">
              <strong> Effort:</strong> ${rec.effort}
            </div>
            <div class="consultant-level">
              <strong> Expertise:</strong> ${rec.consultant_level}
            </div>
            <button class="implement-btn" onclick="implementRecommendation(${index})">
               Implement This
            </button>
          </div>
        `;
      });
      
      recommendationsHTML += '</div>';
      
      // Add to right panel
      rightPanel.innerHTML += recommendationsHTML;
      
      console.log(` ${recommendations.length} strategic recommendations generated by Elite PCP`);
    }
    
    function implementRecommendation(index) {
      console.log(` Implementing recommendation ${index} with full PCP guidance`);
      
      // Start implementation with elite-level guidance
      addDiamondMessage('assistant', ` ELITE PCP IMPLEMENTATION STARTING\n\n Deploying McKinsey-level process optimization\n Dr. Lucy ML analyzing current workflows\n Victory 36 predicting optimal implementation path\n Dream Commander crafting perfect guidance\n Dr. Claude orchestrating tool integrations\n\n This will be executed with world-class consulting excellence!`);
      
      showNotification(' Elite PCP Implementation Started - World-class guidance active!', 'success');
    }
    
    // Initialize Diamond Solutions Menu System
    function initializeDiamondSolutionsMenu() {
      // Load Diamond Solutions Menu
      if (typeof DiamondSolutionsMenu === 'undefined') {
        // Fallback if module not loaded
        console.warn('Diamond Solutions Menu not loaded, creating fallback');
        DiamondSolutionsMenu = {
          categories: [],
          totalSolutions: 138,
          processVoiceCommand: async function(input) { return []; },
          getSolutionById: function(id) { return null; }
        };
      }
      
      // Initialize VisionSpeak if available
      if (typeof VisionSpeakPromiseHandler !== 'undefined') {
        VisionSpeakHandler = new VisionSpeakPromiseHandler();
        console.log(' VisionSpeak voice command system initialized');
      } else {
        console.warn('VisionSpeak not available');
      }
    }

    // Diamond CLI Core Functions
    async function sendDiamondCommand() {
      const input = document.getElementById('diamondCliInput');
      const command = input.value.trim();
      
      if (!command || isProcessingDiamondCommand) return;
      
      isProcessingDiamondCommand = true;
      
      // Add user message
      addDiamondMessage('user', command);
      
      // Show processing with mode indicator
      const currentMode = isProductionMode ? MODES.PRODUCTION : MODES.TESTING;
      addDiamondMessage('processing', ` Processing Diamond SAO command in ${currentMode.name} Mode...`);
      
      try {
        // Simulate Diamond CLI processing
        const result = await processDiamondCommand(command);
        
        // Remove processing message
        removeDiamondProcessingMessage();
        
        // Add response
        addDiamondMessage('assistant', result.response);
        
      } catch (error) {
        removeDiamondProcessingMessage();
        addDiamondMessage('error', ` Command failed: ${error.message}`);
      } finally {
        isProcessingDiamondCommand = false;
        input.value = '';
      }
    }

    async function processDiamondCommand(command) {
      const lowerCommand = command.toLowerCase();
      const currentMode = isProductionMode ? MODES.PRODUCTION : MODES.TESTING;
      
      // Processing delay (shorter for testing, realistic for production)
      const processingDelay = isProductionMode ? Math.random() * 2000 + 1000 : 800;
      await new Promise(resolve => setTimeout(resolve, processingDelay));
      
      let response;
      let service = 'unknown';
      
      // Mode-specific processing header
      const currentEnv = isCloudMode ? ENVIRONMENTS.CLOUD : ENVIRONMENTS.LOCAL;
      const modeHeader = `${currentMode.icon} ${currentMode.name.toUpperCase()} MODE | ${currentEnv.icon} ${currentEnv.name.toUpperCase()} ENV\n${'='.repeat(50)}\n`;
      
      if (lowerCommand.includes('dns') || lowerCommand.includes('domain') || lowerCommand.includes('mcp')) {
        service = 'dns';
        if (isProductionMode) {
          const envDetails = isCloudMode 
            ? 'Google Cloud DNS API (global infrastructure)'
            : 'Local DNS resolver configuration';
          response = `${modeHeader} DNS Operation Complete - LIVE CHANGES APPLIED!

 Diamond SAO processed: "${command}"
 Understanding: Update MCP domain routing (92% confidence)
 Domain: mcp.aipub.2100.cool
 Target: integration-gateway-js
 Service: integration-gateway-js-yutylytffa-uw.a.run.app
 Environment: ${currentEnv.name} (${envDetails})

 PRODUCTION: Real DNS changes applied
Method: diamond_sao_dns_manager_PRODUCTION_${currentEnv.name.toUpperCase()}
 Executed in ${Math.floor(processingDelay)}ms
 DNS propagation initiated ${isCloudMode ? 'globally' : 'locally'}

 Operation logged to Diamond SAO Production Firestore
  Changes are now LIVE and affecting ${isCloudMode ? 'real traffic' : 'local development'}!`;
        } else {
          const envDetails = isCloudMode 
            ? 'Cloud DNS validation (no live changes)'
            : 'Local DNS testing environment';
          response = `${modeHeader} DNS Operation Test Complete - No Live Changes

 Diamond SAO processed: "${command}"
 Understanding: Update MCP domain routing (92% confidence)
 Domain: mcp.aipub.2100.cool (TEST SIMULATION)
 Target: integration-gateway-js
 Service: integration-gateway-js-yutylytffa-uw.a.run.app
 Environment: ${currentEnv.name} (${envDetails})

 TESTING: DNS changes validated, no live modifications made
Method: diamond_sao_dns_manager_TEST_${currentEnv.name.toUpperCase()}
 Executed in ${Math.floor(processingDelay)}ms
 All validations passed - ready for ${isCloudMode ? 'cloud' : 'local'} production deployment

 Test results logged to Diamond SAO Testing Firestore
 Switch to Production Mode to apply real DNS changes`;
        }

      } else if (lowerCommand.includes('worker') || lowerCommand.includes('cloudflare') || lowerCommand.includes('deploy')) {
        service = 'workers';
        if (isProductionMode) {
          response = `${modeHeader} Cloudflare Workers Deployment Complete - LIVE!

 Diamond SAO processed: "${command}"
 Understanding: Deploy worker to Cloudflare (95% confidence)
 Worker: integration-gateway-worker
 Service: integration-gateway

 PRODUCTION: Worker deployed to Cloudflare edge network
Method: diamond_sao_workers_manager_PRODUCTION
 Executed in ${Math.floor(processingDelay)}ms
 Live deployment across 200+ global edge locations

 Operation logged to Diamond SAO Production Firestore
  Worker is now handling LIVE traffic!`;
        } else {
          response = `${modeHeader} Cloudflare Workers Test Complete - No Deployment

 Diamond SAO processed: "${command}"
 Understanding: Deploy worker to Cloudflare (95% confidence)
 Worker: integration-gateway-worker (TEST BUILD)
 Service: integration-gateway

 TESTING: Worker code validated, syntax checked, no live deployment
Method: diamond_sao_workers_manager_TEST
 Executed in ${Math.floor(processingDelay)}ms
 Code validation passed - ready for production deployment

 Test results logged to Diamond SAO Testing Firestore
 Switch to Production Mode to deploy to live Cloudflare edge`;
        }

      } else if (lowerCommand.includes('database') || lowerCommand.includes('mongo') || lowerCommand.includes('collection')) {
        service = 'mongodb';
        response = ` MongoDB Operation Complete!

 Diamond SAO processed: "${command}"
 Understanding: Create database for user profiles (90% confidence)
 Database: user_profiles
 Purpose: User profile management
 Collections: users, profiles, sessions

 Success! - Direct MongoDB API bypassed mongo CLI
Method: diamond_sao_mongodb_manager
 Executed in 932ms

 Operation logged to Diamond SAO Firestore`;

      } else if (lowerCommand.includes('secret') || lowerCommand.includes('key') || lowerCommand.includes('password')) {
        service = 'secrets';
        response = ` GCP Secrets Operation Complete!

 Diamond SAO processed: "${command}"
 Understanding: Retrieve API key from production (90% confidence)
 Secret: api-key
 Environment: production
 Version: latest

 Success! - Direct GCP Secrets API bypassed gcloud CLI
Method: diamond_sao_secrets_manager
 Executed in 654ms
 Secret value: [REDACTED FOR SECURITY]

 Operation logged to Diamond SAO Firestore`;

      } else if (lowerCommand.includes('scale') || lowerCommand.includes('app') || lowerCommand.includes('rollback')) {
        service = 'deployment';
        response = ` App Deployment Operation Complete!

 Diamond SAO processed: "${command}"
 Understanding: Scale application to 5 replicas (88% confidence)
 App: owner-interface
 Target Replicas: 5
 Platform: Cloud Run
 Region: us-west1

 Success! - Direct Platform APIs bypassed Warp Drive CLI
Method: diamond_sao_warp_drive_manager
 Executed in 2.1s

 Operation logged to Diamond SAO Firestore`;

      } else {
        service = 'universal';
        response = ` Diamond SAO Universal Assistant

I understand you're asking about: "${command}"

 I can help you manage your entire infrastructure:
  DNS Management (replaces gcloud CLI)
  Cloudflare Workers (replaces Wrangler CLI) 
  MongoDB Operations (replaces mongo CLI)
  GCP Secrets (replaces gcloud secrets CLI)
  App Deployment (replaces Warp Drive CLI)

Try being more specific, for example:
 "deploy integration gateway worker to cloudflare"
 "update mcp domain to point to integration gateway"  
 "create database for user profiles"
 "get api key secret from production"
 "scale owner interface app to 5 replicas"

 All traditional CLI tools have been replaced with conversational AI!`;
      }
      
      currentDiamondService = service;
      updateDiamondModeIndicator(service);
      
      return { response, service };
    }

    function addDiamondMessage(type, content) {
      const messagesContainer = document.getElementById('copilotMessages');
      const message = document.createElement('div');
      
      if (type === 'user') {
        message.style.cssText = 'background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); color: white; padding: 12px; border-radius: 8px; align-self: flex-end; max-width: 75%; font-size: 11px; margin-bottom: 8px;';
      } else if (type === 'assistant') {
        message.style.cssText = 'background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); color: #93c5fd; padding: 12px; border-radius: 8px; align-self: flex-start; max-width: 85%; font-size: 10px; line-height: 1.4; white-space: pre-line; margin-bottom: 8px;';
      } else if (type === 'processing') {
        message.style.cssText = 'background: rgba(251, 191, 36, 0.1); border: 1px solid rgba(251, 191, 36, 0.3); color: #fbbf24; padding: 8px 12px; border-radius: 8px; align-self: flex-start; max-width: 60%; font-size: 10px; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;';
        message.id = 'processingMessage';
        content = '<div style="width: 12px; height: 12px; border: 2px solid rgba(251, 191, 36, 0.3); border-top: 2px solid #fbbf24; border-radius: 50%; animation: spin 1s linear infinite;"></div>' + content;
        message.innerHTML = content;
        messagesContainer.appendChild(message);
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
        return;
      } else if (type === 'error') {
        message.style.cssText = 'background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); color: #f87171; padding: 12px; border-radius: 8px; align-self: flex-start; max-width: 80%; font-size: 11px; margin-bottom: 8px;';
      }
      
      message.textContent = content;
      messagesContainer.appendChild(message);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    function removeDiamondProcessingMessage() {
      const processing = document.getElementById('processingMessage');
      if (processing) {
        processing.remove();
      }
    }

    function updateDiamondModeIndicator(service) {
      const indicator = document.querySelector('.diamond-mode-indicator span');
      const serviceNames = {
        dns: 'DNS Mode',
        workers: 'Workers Mode',
        mongodb: 'Database Mode',
        secrets: 'Secrets Mode',
        deployment: 'Deploy Mode',
        universal: 'Universal Mode'
      };
      
      if (indicator) {
        indicator.textContent = serviceNames[service] || 'Diamond SAO v34';
      }
    }

    function executeDiamondCommand(command) {
      const input = document.getElementById('diamondCliInput');
      input.value = command;
      sendDiamondCommand();
    }

    function handleDiamondKeyPress(event) {
      if (event.key === 'Enter') {
        event.preventDefault();
        sendDiamondCommand();
      }
    }

    function toggleDiamondMode() {
      const naturalChat = document.getElementById('naturalLanguageChat');
      const cliInterface = document.getElementById('cliInterface');
      const diamondBtn = document.getElementById('diamondModeToggleBtn');
      const cliBtn = document.getElementById('cliModeToggleBtn');
      
      if (isDiamondMode) {
        // Switch to traditional CLI
        naturalChat.style.display = 'none';
        cliInterface.style.display = 'flex';
        isDiamondMode = false;
        
        if (diamondBtn) {
          diamondBtn.innerHTML = '<svg class="enterprise-icon" style="width: 10px; height: 10px; fill: #666;"><use href="#icon-terminal"></use></svg>CLI';
          diamondBtn.style.background = 'rgba(102, 102, 102, 0.2)';
          diamondBtn.style.borderColor = 'rgba(102, 102, 102, 0.4)';
          diamondBtn.style.color = '#666';
          diamondBtn.title = 'Switch to Diamond CLI Mode';
        }
        
      } else {
        // Switch to Diamond CLI
        cliInterface.style.display = 'none';
        naturalChat.style.display = 'flex';
        isDiamondMode = true;
        
        if (cliBtn) {
          cliBtn.innerHTML = '<svg class="enterprise-icon" style="width: 8px; height: 8px; fill: #FFD700;"><use href="#icon-diamond"></use></svg>DIAMOND';
          cliBtn.style.background = 'rgba(255, 215, 0, 0.2)';
          cliBtn.style.borderColor = 'rgba(255, 215, 0, 0.4)';
          cliBtn.style.color = '#FFD700';
          cliBtn.title = 'Switch to Traditional CLI Mode';
        }
      }
    }

    function showDiamondStatus() {
      showNotification(' Diamond SAO Universal CLI v34 - All traditional CLI tools replaced with conversational AI', 'success');
    }

    // Utility Functions
    function showNotification(message, type = 'success') {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, 5000);
    }

    function initializeParticles() {
      const particlesContainer = document.getElementById('particles');
      const particleCount = 50;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 12 + 's';
        particlesContainer.appendChild(particle);
      }
    }

    function togglePanel(header) {
      const content = header.nextElementSibling;
      const chevron = header.querySelector('.chevron-icon');
      
      if (content.classList.contains('active')) {
        content.classList.remove('active');
        header.classList.add('collapsed');
      } else {
        content.classList.add('active');
        header.classList.remove('collapsed');
      }
    }

    function activateRIX(rix, name) {
      // Update active states
      document.querySelectorAll('.copilot-hex-item').forEach(item => {
        item.classList.remove('active');
        item.querySelector('.copilot-name').classList.remove('active');
      });
      
      event.target.closest('.copilot-hex-item').classList.add('active');
      event.target.closest('.copilot-hex-item').querySelector('.copilot-name').classList.add('active');
      
      showNotification(` ${name} RIX activated - Diamond SAO CLI ready`, 'success');
    }

    function handleIntegrationClick(integration) {
      showNotification(` ${integration} integration via Diamond SAO CLI`, 'success');
    }

    function selectIcon(element, type, id) {
      // Update active states
      document.querySelectorAll('.sidebar-icon').forEach(icon => {
        icon.classList.remove('active');
      });
      element.classList.add('active');
      
      showNotification(` Diamond SAO ${type} Squadron activated`, 'success');
    }

    function openSettings() {
      showNotification(' Diamond SAO Settings - All CLI tools replaced with conversational AI', 'success');
    }

    function startVoiceInput() {
      showNotification(' Voice input for Diamond SAO CLI - Coming soon!', 'success');
    }

    // Legacy CLI functions (for compatibility)
    function handleCLIKeyPress(event) {
      if (event.key === 'Enter') {
        executeCLICommand();
      }
    }

    function executeCLICommand() {
      const input = document.getElementById('cliInput');
      const command = input.value.trim();
      
      if (!command) return;
      
      // Add command to terminal
      const terminal = document.getElementById('terminalOutput');
      const commandLine = document.createElement('div');
      commandLine.className = 'terminal-line';
      commandLine.innerHTML = `<span style="color: #50C878;">asoos@diamond</span><span style="color: #0bb1bb;">:</span><span style="color: #4ECDC4;">~</span><span style="color: #e6e6e6;">$ </span><span style="color: #fff;">${command}</span>`;
      terminal.appendChild(commandLine);
      
      // Add response
      const responseLine = document.createElement('div');
      responseLine.className = 'terminal-line';
      responseLine.innerHTML = `<span style="color: #fbbf24;"> Diamond SAO: Command "${command}" processed via conversational AI</span>`;
      terminal.appendChild(responseLine);
      
      const suggestionLine = document.createElement('div');
      suggestionLine.className = 'terminal-line';
      suggestionLine.innerHTML = `<span style="color: #94a3b8;">   Tip: Switch to Diamond mode for natural language commands</span>`;
      terminal.appendChild(suggestionLine);
      
      terminal.scrollTop = terminal.scrollHeight;
      input.value = '';
    }

    function openAPIConfig() {
      showNotification(' Diamond SAO API Configuration - Unified CLI management', 'success');
    }
    
    // ========================================
    // COMPREHENSIVE SOLUTIONS MENU FUNCTIONS
    // ========================================
    
    // Solutions Menu State Management
    function openSolutionsMenu() {
      const overlay = document.getElementById('solutionsMenuOverlay');
      const rightPanel = document.getElementById('rightPanel');
      const contentArea = document.getElementById('contentArea');
      const chatArea = document.getElementById('chatArea');
      
      // Show overlay
      overlay.style.display = 'flex';
      solutionsMenuActive = true;
      
      // Auto-close right panel with animation
      if (rightPanelState === 'open') {
        rightPanel.classList.add('hidden');
        contentArea.classList.add('full-width');
        chatArea.classList.add('expanded');
        rightPanelState = 'closed';
      }
      
      // Populate menu content
      populateSolutionsCategories();
      populatePopularSolutions();
      
      showNotification(' Solutions Menu opened - Right panel auto-closed for focus', 'success');
    }
    
    function closeSolutionsMenu() {
      const overlay = document.getElementById('solutionsMenuOverlay');
      const rightPanel = document.getElementById('rightPanel');
      const contentArea = document.getElementById('contentArea');
      const chatArea = document.getElementById('chatArea');
      
      // Hide overlay
      overlay.style.display = 'none';
      solutionsMenuActive = false;
      
      // Restore right panel
      rightPanel.classList.remove('hidden');
      contentArea.classList.remove('full-width');
      chatArea.classList.remove('expanded');
      rightPanelState = 'open';
      
      showNotification(' Solutions Menu closed - Right panel restored', 'success');
    }
    
    function openVoiceSearch() {
      openSolutionsMenu();
      const searchInput = document.getElementById('solutionsSearchInput');
      searchInput.focus();
      searchInput.placeholder = 'Speak or type: "deploy web app", "setup monitoring", "create database"...';
      
      if (VisionSpeakHandler) {
        startVoiceSearch();
      } else {
        showNotification(' VisionSpeak not available. Use text search instead.', 'warning');
      }
    }
    
    // Populate solutions categories in the menu
    function populateSolutionsCategories() {
      const categoriesContainer = document.getElementById('solutionsCategories');
      
      if (!categoriesContainer) return;
      
      // Fallback categories if DiamondSolutionsMenu not loaded
      const fallbackCategories = [
        { id: 'publishing', name: 'Publishing & Content', icon: '', solutions: { length: 10 } },
        { id: 'infrastructure', name: 'Infrastructure & DevOps', icon: '', solutions: { length: 15 } },
        { id: 'ai-ml', name: 'AI & Machine Learning', icon: '', solutions: { length: 12 } },
        { id: 'security', name: 'Security & Auth', icon: '', solutions: { length: 8 } },
        { id: 'database', name: 'Database & Data', icon: '', solutions: { length: 10 } },
        { id: 'api-integration', name: 'API & Integration', icon: '', solutions: { length: 12 } },
        { id: 'marketing', name: 'Marketing & Growth', icon: '', solutions: { length: 8 } },
        { id: 'analytics', name: 'Analytics & Monitoring', icon: '', solutions: { length: 10 } },
        { id: 'client-services', name: 'Client Services', icon: '', solutions: { length: 8 } },
        { id: 'governance', name: 'Enterprise & Governance', icon: '', solutions: { length: 7 } },
        { id: 'voice-communication', name: 'Voice & Communication', icon: '', solutions: { length: 9 } },
        { id: 'video-vision', name: 'Vision & Video', icon: '', solutions: { length: 6 } },
        { id: 'patent-legal', name: 'Patent & Legal', icon: '', solutions: { length: 5 } },
        { id: 'financial', name: 'Financial & Billing', icon: '', solutions: { length: 7 } },
        { id: 'mobile', name: 'Mobile & Cross-Platform', icon: '', solutions: { length: 8 } },
        { id: 'quantum', name: 'Quantum & Advanced Tech', icon: '', solutions: { length: 5 } }
      ];
      
      const categories = DiamondSolutionsMenu && DiamondSolutionsMenu.categories ? 
        DiamondSolutionsMenu.categories : fallbackCategories;
      
      categoriesContainer.innerHTML = '';
      
      categories.forEach((category, index) => {
        const categoryElement = document.createElement('div');
        categoryElement.className = 'solution-category';
        if (index === 0) categoryElement.classList.add('active');
        categoryElement.onclick = () => selectCategory(category.id, categoryElement);
        
        categoryElement.innerHTML = `
          <div class="category-icon">${category.icon}</div>
          <div class="category-info">
            <div class="category-name">${category.name}</div>
            <div class="category-count">${category.solutions.length} solutions</div>
          </div>
        `;
        
        categoriesContainer.appendChild(categoryElement);
      });
    }
    
    // Select a category and show its solutions
    function selectCategory(categoryId, categoryElement) {
      // Update active category
      document.querySelectorAll('.solution-category').forEach(cat => cat.classList.remove('active'));
      categoryElement.classList.add('active');
      
      // Show category solutions
      populateCategorySolutions(categoryId);
    }
    
    // Populate solutions for a specific category
    function populateCategorySolutions(categoryId) {
      const solutionsContainer = document.getElementById('solutionsList');
      if (!solutionsContainer) return;
      
      let solutions = [];
      
      if (DiamondSolutionsMenu && DiamondSolutionsMenu.categories) {
        const category = DiamondSolutionsMenu.categories.find(cat => cat.id === categoryId);
        if (category) {
          solutions = category.solutions;
        }
      } else {
        // Fallback solutions
        solutions = generateFallbackSolutions(categoryId);
      }
      
      solutionsContainer.innerHTML = '';
      
      solutions.forEach(solution => {
        const solutionElement = document.createElement('div');
        solutionElement.className = 'solution-item';
        solutionElement.onclick = () => executeSolution(solution);
        
        const tags = solution.tags ? solution.tags.map(tag => `<span class="solution-tag">${tag}</span>`).join('') : '';
        
        solutionElement.innerHTML = `
          <div class="solution-name">${solution.name}</div>
          <div class="solution-description">${solution.description}</div>
          <div class="solution-tags">${tags}</div>
        `;
        
        solutionsContainer.appendChild(solutionElement);
      });
    }
    
    // Execute a selected solution with PCP guide
    function executeSolution(solution) {
      closeSolutionsMenu();
      openPCPGuideForSolution(solution);
    }
    
    // Open PCP Conversational Guide for a specific solution
    function openPCPGuideForSolution(solution) {
      const guideOverlay = createPCPGuideOverlay(solution);
      document.body.appendChild(guideOverlay);
      
      // Auto-close right panel for focus
      const rightPanel = document.getElementById('rightPanel');
      const contentArea = document.getElementById('contentArea');
      const chatArea = document.getElementById('chatArea');
      
      if (rightPanelState === 'open') {
        rightPanel.classList.add('hidden');
        contentArea.classList.add('full-width');
        chatArea.classList.add('expanded');
        rightPanelState = 'closed';
      }
      
      showNotification(` Opening PCP Guide for ${solution.name}`, 'success');
    }
    
    // Generate fallback solutions for demonstration
    function generateFallbackSolutions(categoryId) {
      const solutionTemplates = {
        'publishing': [
          { name: 'Ultra-High-Speed Publisher', description: 'Launch complete unified publishing system with 6 engines', tags: ['publishing', 'automation'], command: 'diamond publish start' },
          { name: 'AI Anthology Generator', description: 'Generate complete book collections with AI assistance', tags: ['books', 'ai'], command: 'diamond publish anthology' },
          { name: 'Marketing Campaign Launch', description: 'Deploy marketing campaigns across all channels', tags: ['marketing', 'campaigns'], command: 'diamond publish campaign' }
        ],
        'infrastructure': [
          { name: 'WFA Swarm Deployment', description: 'Deploy quantum-enabled WFA swarm with full orchestration', tags: ['deployment', 'swarm'], command: 'diamond deploy wfa swarm' },
          { name: 'Complete CI/CD Pipeline', description: 'Set up complete CI/CD pipeline with GitHub Actions', tags: ['cicd', 'github'], command: 'diamond infra cicd' },
          { name: 'Auto-Configure Kubernetes', description: 'Automatic Kubernetes cluster setup with monitoring', tags: ['kubernetes', 'scaling'], command: 'diamond infra k8s' }
        ],
        'ai-ml': [
          { name: 'Dream Commander AI System', description: '11M decisions/day AI system with Wings 1-13 formations', tags: ['dream-commander', 'ai'], command: 'diamond dream init' },
          { name: 'Hume AI Voice Intelligence', description: 'Empathic voice intelligence with priority elevation', tags: ['hume-ai', 'voice'], command: 'diamond hume grant' },
          { name: 'Auto ML Model Training', description: 'Automated machine learning model training pipeline', tags: ['ml', 'training'], command: 'diamond ml train' }
        ]
      };
      
      return solutionTemplates[categoryId] || [];
    }
    
    // Populate popular solutions by default
    function populatePopularSolutions() {
      const popularSolutions = [
        { id: 'ultra-speed-publisher', name: 'Ultra-High-Speed Publisher', description: 'Launch complete unified publishing system', tags: ['popular', 'publishing'], command: 'diamond publish start' },
        { id: 'wfa-swarm', name: 'WFA Swarm Deployment', description: 'Deploy quantum-enabled WFA swarm', tags: ['popular', 'deployment'], command: 'diamond deploy wfa swarm' },
        { id: 'dream-commander', name: 'Dream Commander AI', description: '11M decisions/day AI system', tags: ['popular', 'ai'], command: 'diamond dream init' },
        { id: 'victory36', name: 'Victory36 Security', description: 'Connect Victory36 security system', tags: ['popular', 'security'], command: 'diamond victory36 connect' },
        { id: 'voice-synthesis', name: 'Voice Synthesis', description: 'ElevenLabs voice synthesis with 14 pilots', tags: ['popular', 'voice'], command: 'diamond voice synthesis' },
        { id: 'mongodb-automation', name: 'MongoDB Automation', description: 'Complete MongoDB Atlas setup', tags: ['popular', 'database'], command: 'diamond db mongo' }
      ];
      
      const solutionsContainer = document.getElementById('solutionsList');
      if (!solutionsContainer) return;
      
      solutionsContainer.innerHTML = '<h3 style="color: #a855f7; margin-bottom: 15px;"> Popular Solutions</h3>';
      
      popularSolutions.forEach(solution => {
        const solutionElement = document.createElement('div');
        solutionElement.className = 'solution-item';
        solutionElement.onclick = () => executeSolution(solution);
        
        const tags = solution.tags.map(tag => `<span class="solution-tag">${tag}</span>`).join('');
        
        solutionElement.innerHTML = `
          <div class="solution-name">${solution.name}</div>
          <div class="solution-description">${solution.description}</div>
          <div class="solution-tags">${tags}</div>
        `;
        
        solutionsContainer.appendChild(solutionElement);
      });
    }
    
    // Search solutions functionality
    function searchSolutions(event) {
      const searchTerm = event.target.value.toLowerCase();
      const solutionsContainer = document.getElementById('solutionsList');
      
      if (searchTerm.length < 2) {
        populatePopularSolutions();
        return;
      }
      
      // Perform search across all solutions
      performSolutionsSearch(searchTerm);
    }
    
    // Perform comprehensive search
    async function performSolutionsSearch(searchTerm) {
      const solutionsContainer = document.getElementById('solutionsList');
      if (!solutionsContainer) return;
      
      let searchResults = [];
      
      if (DiamondSolutionsMenu && DiamondSolutionsMenu.processVoiceCommand) {
        try {
          searchResults = await DiamondSolutionsMenu.processVoiceCommand(searchTerm);
        } catch (error) {
          console.warn('Search error:', error);
        }
      }
      
      // Fallback search if no results or no menu available
      if (searchResults.length === 0) {
        searchResults = performFallbackSearch(searchTerm);
      }
      
      solutionsContainer.innerHTML = `<h3 style="color: #a855f7; margin-bottom: 15px;"> Search Results for "${searchTerm}" (${searchResults.length})</h3>`;
      
      if (searchResults.length === 0) {
        solutionsContainer.innerHTML += '<p style="color: #888; text-align: center; padding: 20px;">No solutions found. Try different keywords.</p>';
        return;
      }
      
      searchResults.forEach(solution => {
        const solutionElement = document.createElement('div');
        solutionElement.className = 'solution-item';
        solutionElement.onclick = () => executeSolution(solution);
        
        const tags = solution.tags ? solution.tags.map(tag => `<span class="solution-tag">${tag}</span>`).join('') : '';
        const matchBadge = solution.matchType ? `<span class="solution-tag" style="background: #10b981; color: white;">${solution.matchType} match</span>` : '';
        
        solutionElement.innerHTML = `
          <div class="solution-name">${solution.name} ${solution.categoryIcon || ''}</div>
          <div class="solution-description">${solution.description}</div>
          <div class="solution-tags">${tags} ${matchBadge}</div>
        `;
        
        solutionsContainer.appendChild(solutionElement);
      });
    }
    
    // Fallback search for demonstration
    function performFallbackSearch(searchTerm) {
      const allSolutions = [
        { name: 'Deploy Web Application', description: 'Deploy web applications with automated CI/CD', tags: ['deployment', 'web'], command: 'diamond deploy web' },
        { name: 'Setup Monitoring', description: 'Real-time system monitoring and alerting', tags: ['monitoring', 'alerts'], command: 'diamond monitor setup' },
        { name: 'Create Database', description: 'MongoDB database setup with auto-scaling', tags: ['database', 'mongodb'], command: 'diamond db create' },
        { name: 'Security Scan', description: 'Automated vulnerability scanning', tags: ['security', 'scan'], command: 'diamond security scan' },
        { name: 'API Gateway', description: 'Deploy API gateway with 9000 connectors', tags: ['api', 'gateway'], command: 'diamond api gateway' }
      ];
      
      return allSolutions.filter(solution => 
        solution.name.toLowerCase().includes(searchTerm) ||
        solution.description.toLowerCase().includes(searchTerm) ||
        solution.tags.some(tag => tag.toLowerCase().includes(searchTerm))
      );
    }
    
    // Voice search functionality
    function startVoiceSearch() {
      if (!VisionSpeakHandler) {
        showNotification(' VisionSpeak not available. Use text search instead.', 'warning');
        return;
      }
      
      const searchInput = document.getElementById('solutionsSearchInput');
      searchInput.placeholder = ' Listening... Speak your request or type it.';
      
      // Simulate voice input (in real implementation, this would use actual voice recognition)
      showNotification(' Voice search activated - Type your request for now', 'success');
      
      setTimeout(() => {
        searchInput.placeholder = 'Search solutions, categories, or use voice commands...';
      }, 3000);
    }
    
    // ========================================
    // PCP CONVERSATIONAL GUIDE SYSTEM
    // ========================================
    
    // Create PCP Guide overlay for a specific solution
    function createPCPGuideOverlay(solution) {
      const overlay = document.createElement('div');
      overlay.className = 'pcp-guide-overlay';
      overlay.id = `pcpGuide_${solution.id || solution.name.replace(/\s/g, '')}`;
      
      const guideData = getPCPGuideData(solution);
      
      overlay.innerHTML = `
        <div class="pcp-guide-container">
          <div class="pcp-guide-header">
            <div class="pcp-identity">
              <div class="pcp-avatar"></div>
              <div class="pcp-info">
                <h2>${guideData.pcpName}</h2>
                <p class="pcp-title">Your ${guideData.expertiseArea} PCP</p>
              </div>
            </div>
            <button class="pcp-guide-close" onclick="closePCPGuide('${overlay.id}')">&times;</button>
          </div>
          
          <div class="pcp-guide-content">
            <div class="guide-welcome">
              <div class="conversation-bubble pcp-bubble">
                <h3> ${guideData.welcomeMessage}</h3>
                <p>${guideData.introText}</p>
              </div>
            </div>
            
            <div class="guide-sections">
              <div class="guide-section">
                <h4> What This Tool Does</h4>
                <div class="capability-cards">
                  ${guideData.capabilities.map(cap => `
                    <div class="capability-card">
                      <div class="capability-icon">${cap.icon}</div>
                      <div class="capability-info">
                        <h5>${cap.name}</h5>
                        <p>${cap.description}</p>
                      </div>
                    </div>
                  `).join('')}
                </div>
              </div>
              
              <div class="guide-section">
                <h4> How to Speak with Your PCP About This</h4>
                <div class="conversation-examples">
                  ${guideData.conversationExamples.map(example => `
                    <div class="conversation-example" onclick="tryConversationExample('${example.phrase}')">
                      <div class="example-icon"></div>
                      <div class="example-text">
                        <strong>"${example.phrase}"</strong>
                        <small>${example.explanation}</small>
                      </div>
                    </div>
                  `).join('')}
                </div>
              </div>
              
              <div class="guide-section">
                <h4> Project Workflow: Beginning to End</h4>
                <div class="workflow-steps">
                  ${guideData.workflow.map((step, index) => `
                    <div class="workflow-step" onclick="executeWorkflowStep('${solution.id}', ${index})">
                      <div class="step-number">${index + 1}</div>
                      <div class="step-content">
                        <h5>${step.title}</h5>
                        <p>${step.description}</p>
                        <div class="step-pcp-says">
                          <em> PCP Suggestion: "${step.pcpSuggestion}"</em>
                        </div>
                      </div>
                      <div class="step-action">
                        <button class="step-btn">Start This Step</button>
                      </div>
                    </div>
                  `).join('')}
                </div>
              </div>
              
              <div class="guide-section">
                <h4> Pro Tips from Your PCP</h4>
                <div class="pcp-tips">
                  ${guideData.proTips.map(tip => `
                    <div class="pcp-tip">
                      <div class="tip-icon">${tip.icon}</div>
                      <div class="tip-content">
                        <strong>${tip.title}</strong>
                        <p>${tip.advice}</p>
                      </div>
                    </div>
                  `).join('')}
                </div>
              </div>
            </div>
          </div>
          
          <div class="pcp-guide-actions">
            <button onclick="startCollaborativeSession('${solution.id}')" class="primary-action-btn">
               Start Collaborative Session
            </button>
            <button onclick="quickStart('${solution.id}')" class="secondary-action-btn">
               Quick Start
            </button>
            <button onclick="scheduleSession('${solution.id}')" class="tertiary-action-btn">
               Schedule Deep Dive
            </button>
          </div>
        </div>
      `;
      
      return overlay;
    }
    
    // Get PCP guide data for a solution
    function getPCPGuideData(solution) {
      const guideDatabase = {
        'ultra-speed-publisher': {
          pcpName: 'Dr. Memoria',
          expertiseArea: 'Publishing Intelligence',
          welcomeMessage: 'Ready to launch your publishing empire?',
          introText: 'I\'m Dr. Memoria, your Publishing Intelligence PCP. I\'ll guide you through creating a high-speed publishing system that can handle everything from book creation to global distribution. Let\'s collaborate to build something extraordinary.',
          capabilities: [
            { icon: '', name: 'Six-Engine Publisher', description: 'Unified system with content, distribution, domain, intelligence, anthology, and integration engines' },
            { icon: '', name: 'Ultra-High Speed', description: 'Process thousands of publications simultaneously with quantum-level performance' },
            { icon: '', name: 'Global Distribution', description: 'Automatic distribution across 200+ platforms and marketplaces worldwide' },
            { icon: '', name: 'AI Content Enhancement', description: 'Intelligent content optimization, SEO, and audience targeting' }
          ],
          conversationExamples: [
            { phrase: 'Help me launch a comprehensive publishing system', explanation: 'I\'ll guide you through setting up all six engines for maximum efficiency' },
            { phrase: 'Let\'s collaborate on scaling my publishing operations', explanation: 'We\'ll work together to optimize your workflow and automate repetitive tasks' },
            { phrase: 'I want to publish 100 books this quarter', explanation: 'I\'ll create a strategic plan with timeline and resource allocation' },
            { phrase: 'Show me how to integrate AI into my publishing workflow', explanation: 'I\'ll demonstrate AI-powered content enhancement and optimization techniques' }
          ],
          workflow: [
            {
              title: 'Publishing Strategy & Planning',
              description: 'Define your publishing goals, target audience, and content strategy',
              pcpSuggestion: 'Let\'s start by understanding your vision. What kind of impact do you want to make with your publications?'
            },
            {
              title: 'Content Engine Setup',
              description: 'Configure the content creation and management system',
              pcpSuggestion: 'I\'ll help you set up automated content workflows that maintain quality while maximizing speed'
            },
            {
              title: 'Distribution Network Integration',
              description: 'Connect with global distribution channels and platforms',
              pcpSuggestion: 'We\'ll establish relationships with 200+ distribution partners to maximize your reach'
            },
            {
              title: 'Intelligence Layer Activation',
              description: 'Enable AI-powered analytics, optimization, and audience insights',
              pcpSuggestion: 'Let me show you how our AI can predict market trends and optimize your content strategy'
            },
            {
              title: 'Launch & Scale Operations',
              description: 'Execute your publishing plan and continuously optimize performance',
              pcpSuggestion: 'I\'ll monitor performance and suggest real-time optimizations to maximize your success'
            }
          ],
          proTips: [
            { icon: '', title: 'Niche Focus First', advice: 'Start with a specific niche to build authority, then expand. I\'ll help identify the most profitable niches for your expertise.' },
            { icon: '', title: 'Data-Driven Decisions', advice: 'Use our analytics dashboard daily. I\'ll interpret the data and provide actionable insights for continuous improvement.' },
            { icon: '', title: 'Automation is Key', advice: 'Automate everything possible. I\'ll help you identify which processes can be automated for maximum efficiency gains.' }
          ]
        },
        'wfa-swarm-deployment': {
          pcpName: 'Dr. Roark',
          expertiseArea: 'Quantum Infrastructure',
          welcomeMessage: 'Ready to deploy quantum-level infrastructure?',
          introText: 'I\'m Dr. Roark, your Quantum Infrastructure PCP. The WFA Swarm represents our most advanced deployment technology. I\'ll guide you through harnessing quantum-entangled systems for unprecedented scalability.',
          capabilities: [
            { icon: '', name: 'Quantum Swarm Technology', description: 'Deploy quantum-entangled infrastructure that scales beyond traditional limitations' },
            { icon: '', name: 'Wave Function Amplification', description: 'Amplify computational power through quantum wave function manipulation' },
            { icon: '', name: 'Predictive Scaling', description: 'AI-powered infrastructure that predicts and scales before demand spikes' },
            { icon: '', name: 'Quantum Security', description: 'Unhackable quantum encryption and security protocols' }
          ],
          conversationExamples: [
            { phrase: 'Deploy a quantum swarm for my enterprise infrastructure', explanation: 'I\'ll orchestrate a quantum deployment with full redundancy and security' },
            { phrase: 'Help me scale beyond traditional cloud limitations', explanation: 'We\'ll implement quantum scaling that transcends physical infrastructure boundaries' },
            { phrase: 'I need infrastructure that can handle millions of concurrent users', explanation: 'Let\'s deploy a swarm configuration optimized for massive scale operations' },
            { phrase: 'Show me how quantum entanglement improves performance', explanation: 'I\'ll demonstrate the quantum advantage in real-world infrastructure scenarios' }
          ],
          workflow: [
            {
              title: 'Infrastructure Assessment',
              description: 'Analyze current infrastructure and define quantum upgrade requirements',
              pcpSuggestion: 'Let\'s evaluate your current setup and identify where quantum technology will provide the biggest impact'
            },
            {
              title: 'Quantum Architecture Design',
              description: 'Design quantum-enhanced infrastructure topology',
              pcpSuggestion: 'I\'ll create a quantum architecture that seamlessly integrates with your existing systems'
            },
            {
              title: 'WFA Swarm Deployment',
              description: 'Deploy quantum swarm with wave function amplification',
              pcpSuggestion: 'We\'ll execute a phased deployment to minimize disruption while maximizing quantum advantages'
            },
            {
              title: 'Quantum Entanglement Verification',
              description: 'Verify quantum entanglement and security protocols',
              pcpSuggestion: 'I\'ll run comprehensive tests to ensure quantum coherence and security integrity'
            },
            {
              title: 'Performance Optimization',
              description: 'Fine-tune quantum parameters for optimal performance',
              pcpSuggestion: 'Let me optimize the quantum configurations for your specific workload patterns'
            }
          ],
          proTips: [
            { icon: '', title: 'Quantum Coherence', advice: 'Maintain quantum coherence by minimizing environmental interference. I\'ll set up monitoring to protect quantum states.' },
            { icon: '', title: 'Progressive Enhancement', advice: 'Gradually migrate workloads to quantum systems. I\'ll help prioritize which services benefit most from quantum acceleration.' },
            { icon: '', title: 'Quantum Networking', advice: 'Use quantum networking for ultra-secure communication. I\'ll configure quantum key distribution for maximum security.' }
          ]
        },
        'dream-commander': {
          pcpName: 'Dr. Lucy',
          expertiseArea: 'AI Decision Intelligence',
          welcomeMessage: 'Ready to command 11 million decisions per day?',
          introText: 'I\'m Dr. Lucy, your AI Decision Intelligence PCP. Dream Commander represents the pinnacle of automated decision-making with Wings 1-13 formations processing 11 million decisions daily. Let\'s harness this power for your organization.',
          capabilities: [
            { icon: '', name: '11M Daily Decisions', description: 'Process and execute 11 million intelligent decisions every single day' },
            { icon: '', name: 'Wings 1-13 Formations', description: 'Thirteen specialized AI wings handling different decision domains' },
            { icon: '', name: 'Time-Based Predictions', description: 'Predictive decision-making based on temporal analysis and pattern recognition' },
            { icon: '', name: 'Real-Time Execution', description: 'Instant decision implementation with automated execution workflows' }
          ],
          conversationExamples: [
            { phrase: 'Help me automate all strategic business decisions', explanation: 'I\'ll configure Dream Commander to handle your strategic decision workflows intelligently' },
            { phrase: 'Let\'s set up predictive decision-making for market opportunities', explanation: 'We\'ll implement time-based prediction algorithms that identify and act on opportunities' },
            { phrase: 'I need an AI system that can make 11 million decisions daily', explanation: 'I\'ll deploy the full Dream Commander system with all Wings formations activated' },
            { phrase: 'Show me how Wings formations can manage different business areas', explanation: 'I\'ll demonstrate how each Wing specializes in different decision domains for optimal efficiency' }
          ],
          workflow: [
            {
              title: 'Decision Architecture Mapping',
              description: 'Map your organization\'s decision-making processes and hierarchies',
              pcpSuggestion: 'Let\'s identify all the decisions your organization makes and classify them by complexity and frequency'
            },
            {
              title: 'Wings Formation Configuration',
              description: 'Configure Wings 1-13 for your specific decision domains',
              pcpSuggestion: 'I\'ll assign each Wing to handle specific business areas - from operations to strategy to innovation'
            },
            {
              title: 'Intelligence Training Phase',
              description: 'Train the AI on your organization\'s decision patterns and outcomes',
              pcpSuggestion: 'We\'ll feed historical decision data to train the system on your organization\'s unique decision style'
            },
            {
              title: 'Predictive Model Activation',
              description: 'Activate time-based prediction algorithms for proactive decision-making',
              pcpSuggestion: 'I\'ll enable predictive capabilities that anticipate decisions before they\'re needed'
            },
            {
              title: 'Full System Launch',
              description: 'Launch Dream Commander with full 11M daily decision capacity',
              pcpSuggestion: 'Let\'s go live with the complete system and monitor its decision-making performance in real-time'
            }
          ],
          proTips: [
            { icon: '', title: 'Decision Hierarchy', advice: 'Establish clear decision hierarchies. I\'ll help you define which decisions require human oversight and which can be fully automated.' },
            { icon: '', title: 'Performance Metrics', advice: 'Track decision quality over time. I\'ll provide detailed analytics on decision outcomes and continuous improvement suggestions.' },
            { icon: '', title: 'Feedback Loops', advice: 'Implement decision feedback loops. I\'ll ensure the system learns from every decision outcome to improve future performance.' }
          ]
        }
      };
      
      // Return specific guide data or fallback generic guide
      return guideDatabase[solution.id] || generateGenericGuide(solution);
    }
    
    // Generate generic guide for solutions not in database
    function generateGenericGuide(solution) {
      return {
        pcpName: 'Diamond SAO',
        expertiseArea: 'Solution Architecture',
        welcomeMessage: `Ready to master ${solution.name}?`,
        introText: `I'm your Solution Architecture PCP. I'll guide you through implementing ${solution.name} from concept to completion. Let's collaborate to achieve your goals efficiently and effectively.`,
        capabilities: [
          { icon: '', name: 'Strategic Implementation', description: 'End-to-end solution implementation with strategic planning' },
          { icon: '', name: 'Technical Excellence', description: 'Best practices implementation with technical optimization' },
          { icon: '', name: 'Performance Monitoring', description: 'Real-time monitoring and performance optimization' },
          { icon: '', name: 'Collaborative Approach', description: 'Human-AI collaboration for optimal outcomes' }
        ],
        conversationExamples: [
          { phrase: `Help me implement ${solution.name}`, explanation: 'I\'ll guide you through the complete implementation process' },
          { phrase: `Let's collaborate on optimizing this solution`, explanation: 'We\'ll work together to find the best approach for your specific needs' },
          { phrase: `Show me the best practices for this tool`, explanation: 'I\'ll share proven strategies and optimization techniques' },
          { phrase: `Walk me through this solution step by step`, explanation: 'I\'ll provide detailed guidance throughout the entire process' }
        ],
        workflow: [
          {
            title: 'Requirements Analysis',
            description: 'Understand your specific needs and objectives',
            pcpSuggestion: 'Let\'s start by understanding exactly what you want to achieve with this solution'
          },
          {
            title: 'Solution Design',
            description: 'Design the optimal implementation approach',
            pcpSuggestion: 'I\'ll create a customized implementation plan tailored to your requirements'
          },
          {
            title: 'Implementation',
            description: 'Execute the solution with continuous guidance',
            pcpSuggestion: 'We\'ll implement this step by step, ensuring quality at every stage'
          },
          {
            title: 'Testing & Validation',
            description: 'Verify the solution meets all requirements',
            pcpSuggestion: 'I\'ll help you test thoroughly to ensure everything works perfectly'
          },
          {
            title: 'Optimization & Scaling',
            description: 'Fine-tune performance and prepare for scaling',
            pcpSuggestion: 'Let\'s optimize the solution and prepare it for future growth'
          }
        ],
        proTips: [
          { icon: '', title: 'Start Small', advice: 'Begin with a pilot implementation to validate the approach before full deployment.' },
          { icon: '', title: 'Document Everything', advice: 'Maintain detailed documentation for future reference and team collaboration.' },
          { icon: '', title: 'Iterate Continuously', advice: 'Use feedback loops to continuously improve and optimize the solution.' }
        ]
      };
    }
    
    // ========================================
    // AI-ADAPTIVE LAYOUT SYSTEM
    // ========================================
    
    // Close PCP Guide
    function closePCPGuide(overlayId) {
      const overlay = document.getElementById(overlayId);
      if (overlay) {
        overlay.remove();
      }
      
      // Restore right panel
      const rightPanel = document.getElementById('rightPanel');
      const contentArea = document.getElementById('contentArea');
      const chatArea = document.getElementById('chatArea');
      
      if (rightPanelState === 'closed') {
        rightPanel.classList.remove('hidden');
        contentArea.classList.remove('full-width');
        chatArea.classList.remove('expanded');
        rightPanelState = 'open';
      }
      
      showNotification(' PCP Guide closed - Right panel restored', 'success');
    }
    
    // Try conversation example
    function tryConversationExample(phrase) {
      const input = document.getElementById('diamondCliInput');
      if (input) {
        input.value = phrase;
        input.focus();
        
        // Close all overlays
        document.querySelectorAll('.pcp-guide-overlay').forEach(overlay => overlay.remove());
        
        // Trigger the command processing
        setTimeout(() => {
          sendDiamondCommand();
        }, 500);
        
        showNotification(` Trying: "${phrase}"`, 'success');
      }
    }
    
    // Execute workflow step with adaptive layout
    function executeWorkflowStep(solutionId, stepIndex) {
      const solution = { id: solutionId, name: solutionId.replace(/-/g, ' ').toUpperCase() };
      const layoutMode = determineLayoutMode(solutionId, stepIndex);
      
      // Apply adaptive layout
      applyAdaptiveLayout(layoutMode, solution, stepIndex);
      
      showNotification(` Starting Step ${stepIndex + 1} for ${solution.name}`, 'success');
    }
    
    // Determine optimal layout mode based on solution and step
    function determineLayoutMode(solutionId, stepIndex) {
      const layoutModes = {
        'ultra-speed-publisher': {
          0: 'planning', // Strategy & Planning
          1: 'coding', // Content Engine Setup
          2: 'integration', // Distribution Network
          3: 'monitoring', // Intelligence Layer
          4: 'visualization' // Launch & Scale
        },
        'wfa-swarm-deployment': {
          0: 'analysis', // Infrastructure Assessment
          1: 'coding', // Architecture Design
          2: 'deployment', // WFA Swarm Deployment
          3: 'monitoring', // Verification
          4: 'visualization' // Optimization
        },
        'dream-commander': {
          0: 'planning', // Decision Mapping
          1: 'coding', // Wings Configuration
          2: 'training', // Intelligence Training
          3: 'monitoring', // Predictive Models
          4: 'visualization' // Full System Launch
        }
      };
      
      return layoutModes[solutionId]?.[stepIndex] || 'balanced';
    }
    
    // Apply adaptive layout based on task context
    function applyAdaptiveLayout(mode, solution, stepIndex) {
      const chatArea = document.getElementById('chatArea');
      const rightPanel = document.getElementById('rightPanel');
      const contentArea = document.getElementById('contentArea');
      
      // Close PCP guides
      document.querySelectorAll('.pcp-guide-overlay').forEach(overlay => overlay.remove());
      
      // Remove existing layout classes
      chatArea.classList.remove('expanded', 'coding-mode', 'preview-mode', 'balanced-mode');
      rightPanel.classList.remove('hidden', 'preview-large', 'info-panel');
      contentArea.classList.remove('full-width');
      
      switch (mode) {
        case 'coding':
          // Left larger for coding, right smaller for PCP guidance
          chatArea.style.flex = '2';
          rightPanel.style.width = '280px';
          rightPanel.classList.add('info-panel');
          setupCodingInterface(solution, stepIndex);
          break;
          
        case 'visualization':
          // Right larger for previews, left smaller for controls
          chatArea.style.flex = '1';
          rightPanel.style.width = '60%';
          rightPanel.classList.add('preview-large');
          setupVisualizationInterface(solution, stepIndex);
          break;
          
        case 'monitoring':
          // Balanced for monitoring dashboards
          chatArea.style.flex = '1';
          rightPanel.style.width = '40%';
          setupMonitoringInterface(solution, stepIndex);
          break;
          
        case 'planning':
          // Right panel for approvals, left for planning
          chatArea.style.flex = '1.5';
          rightPanel.style.width = '35%';
          setupPlanningInterface(solution, stepIndex);
          break;
          
        default: // balanced
          chatArea.style.flex = '1';
          rightPanel.style.width = '320px';
          setupBalancedInterface(solution, stepIndex);
      }
      
      // Ensure right panel is visible
      if (rightPanelState === 'closed') {
        rightPanel.classList.remove('hidden');
        contentArea.classList.remove('full-width');
        chatArea.classList.remove('expanded');
        rightPanelState = 'open';
      }
      
      // Add smooth transition
      chatArea.style.transition = 'all 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
      rightPanel.style.transition = 'all 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
    }
    
    // Setup coding interface (left side for coding, right side for PCP guidance)
    function setupCodingInterface(solution, stepIndex) {
      const rightPanel = document.getElementById('rightPanel');
      const chatArea = document.getElementById('chatArea');
      
      // Left side: Show code editor or input areas
      addDiamondMessage('assistant', ` CODING MODE ACTIVATED\n\n Setting up development environment for ${solution.name}\n\nLeft Side: Your coding workspace\nRight Side: PCP guidance and real-time help\n\nStart coding and I'll provide real-time assistance!`);
      
      // Right side: PCP guidance panel
      rightPanel.innerHTML = `
        <div class="pcp-coding-panel">
          <div class="panel-card">
            <div class="panel-header">
              <div class="panel-title">
                 PCP Coding Assistant
              </div>
            </div>
            <div class="panel-content active">
              <div class="coding-guidance">
                <h4> Step ${stepIndex + 1} Guidance</h4>
                <p>I'm here to help you code efficiently. As you work, I'll provide:</p>
                <ul>
                  <li>Real-time code suggestions</li>
                  <li>Best practice recommendations</li>
                  <li>Error detection and fixes</li>
                  <li>Optimization tips</li>
                </ul>
                <div class="quick-actions">
                  <button onclick="askPCPQuestion('coding')" class="pcp-help-btn"> Ask PCP Question</button>
                  <button onclick="requestCodeReview()" class="pcp-help-btn"> Code Review</button>
                  <button onclick="getOptimizationTips()" class="pcp-help-btn"> Optimize Code</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
      
      showNotification(' Coding Mode - Left: Code, Right: PCP Guidance', 'success');
    }
    
    // Setup visualization interface (left side for controls, right side for preview)
    function setupVisualizationInterface(solution, stepIndex) {
      const rightPanel = document.getElementById('rightPanel');
      
      // Left side: Controls and settings
      addDiamondMessage('assistant', ` VISUALIZATION MODE ACTIVATED\n\n Setting up preview environment for ${solution.name}\n\nLeft Side: Controls and settings\nRight Side: Live preview and visualization\n\nMake changes and see them instantly!`);
      
      // Right side: Large preview area with PCP approval system
      rightPanel.innerHTML = `
        <div class="pcp-preview-panel">
          <div class="preview-header">
            <h3> Live Preview</h3>
            <div class="preview-controls">
              <button onclick="refreshPreview()" class="preview-btn"> Refresh</button>
              <button onclick="fullscreenPreview()" class="preview-btn"> Fullscreen</button>
            </div>
          </div>
          
          <div class="preview-area" id="livePreviewArea">
            <div class="preview-placeholder">
              <div class="preview-icon"></div>
              <p>Live preview will appear here</p>
              <p>Changes on the left will be reflected instantly</p>
            </div>
          </div>
          
          <div class="pcp-approval-section">
            <div class="approval-message">
              <h4> PCP Review</h4>
              <p>"Looking great! The layout is responsive and the colors work well together. Ready to proceed?"</p>
            </div>
            <div class="approval-actions">
              <button onclick="approvePCPRecommendation()" class="approve-btn"> Approve</button>
              <button onclick="requestPCPChanges()" class="revise-btn"> Request Changes</button>
              <button onclick="askPCPQuestion('design')" class="ask-btn"> Ask PCP</button>
            </div>
          </div>
        </div>
      `;
      
      showNotification(' Visualization Mode - Left: Controls, Right: Live Preview', 'success');
    }
    
    // Setup monitoring interface (balanced for dashboards)
    function setupMonitoringInterface(solution, stepIndex) {
      const rightPanel = document.getElementById('rightPanel');
      
      addDiamondMessage('assistant', ` MONITORING MODE ACTIVATED\n\n Setting up monitoring dashboard for ${solution.name}\n\nLeft Side: Configuration and controls\nRight Side: Real-time metrics and alerts\n\nMonitoring systems are now active!`);
      
      // Right side: Monitoring dashboard
      rightPanel.innerHTML = `
        <div class="pcp-monitoring-panel">
          <div class="panel-card">
            <div class="panel-header">
              <div class="panel-title">
                 Real-Time Monitoring
              </div>
            </div>
            <div class="panel-content active">
              <div class="monitoring-metrics">
                <div class="metric-card">
                  <div class="metric-value">98.5%</div>
                  <div class="metric-label">System Health</div>
                </div>
                <div class="metric-card">
                  <div class="metric-value">1.2ms</div>
                  <div class="metric-label">Response Time</div>
                </div>
                <div class="metric-card">
                  <div class="metric-value">45.7K</div>
                  <div class="metric-label">Active Sessions</div>
                </div>
              </div>
              
              <div class="pcp-insights">
                <h4> PCP Insights</h4>
                <div class="insight-item">
                  <span class="insight-icon"></span>
                  <span>All systems operating optimally</span>
                </div>
                <div class="insight-item">
                  <span class="insight-icon"></span>
                  <span>Traffic increased 15% today</span>
                </div>
                <div class="insight-item">
                  <span class="insight-icon"></span>
                  <span>Consider scaling at 50K sessions</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
      
      showNotification(' Monitoring Mode - Balanced layout for dashboards', 'success');
    }
    
    // Setup planning interface (right side for approvals)
    function setupPlanningInterface(solution, stepIndex) {
      const rightPanel = document.getElementById('rightPanel');
      
      addDiamondMessage('assistant', ` PLANNING MODE ACTIVATED\n\n Strategic planning phase for ${solution.name}\n\nLeft Side: Planning workspace and inputs\nRight Side: PCP recommendations and approvals\n\nLet's create a comprehensive plan together!`);
      
      // Right side: PCP planning and approval panel
      rightPanel.innerHTML = `
        <div class="pcp-planning-panel">
          <div class="panel-card">
            <div class="panel-header">
              <div class="panel-title">
                 Strategic Plan Review
              </div>
            </div>
            <div class="panel-content active">
              <div class="plan-summary">
                <h4> Current Plan</h4>
                <div class="plan-item">
                  <span class="plan-icon"></span>
                  <span>Define objectives and success metrics</span>
                </div>
                <div class="plan-item">
                  <span class="plan-icon"></span>
                  <span>Analyze current state and requirements</span>
                </div>
                <div class="plan-item">
                  <span class="plan-icon"></span>
                  <span>Create implementation roadmap</span>
                </div>
              </div>
              
              <div class="pcp-recommendation">
                <h4> PCP Recommendation</h4>
                <p>"Based on your requirements, I recommend starting with a pilot implementation. This approach reduces risk and allows for iterative improvements."</p>
                
                <div class="recommendation-actions">
                  <button onclick="approvePlan()" class="approve-btn"> Approve Plan</button>
                  <button onclick="modifyPlan()" class="modify-btn"> Modify</button>
                  <button onclick="askPCPQuestion('planning')" class="ask-btn"> Ask PCP</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
      
      showNotification(' Planning Mode - Right side ready for approvals', 'success');
    }
    
    // Setup balanced interface (default)
    function setupBalancedInterface(solution, stepIndex) {
      // Restore original right panel content
      location.reload(); // Temporary - in production, would restore specific content
      
      addDiamondMessage('assistant', ` BALANCED MODE ACTIVATED\n\n Standard layout for ${solution.name}\n\nLeft Side: Main workspace\nRight Side: Information and controls\n\nWorking in balanced mode for optimal productivity!`);
      
      showNotification(' Balanced Mode - Standard layout restored', 'success');
    }
    
    // ========================================
    // PCP INTERACTION HANDLERS
    // ========================================
    
    // Start collaborative session
    function startCollaborativeSession(solutionId) {
      document.querySelectorAll('.pcp-guide-overlay').forEach(overlay => overlay.remove());
      
      addDiamondMessage('assistant', ` COLLABORATIVE SESSION STARTED\n\n Your PCP is now fully engaged for ${solutionId}\n\n Natural conversation mode activated\n Adaptive layout ready\n Tool blending enabled\n\nJust tell me what you want to accomplish and I'll guide you through it!`);
      
      showNotification(' Collaborative Session Started - PCP fully engaged!', 'success');
    }
    
    // Quick start a solution
    function quickStart(solutionId) {
      document.querySelectorAll('.pcp-guide-overlay').forEach(overlay => overlay.remove());
      
      const solution = { id: solutionId, name: solutionId.replace(/-/g, ' ') };
      applyAdaptiveLayout('coding', solution, 1);
      
      addDiamondMessage('assistant', ` QUICK START ACTIVATED\n\n Launching ${solution.name} with optimal settings\n\n Environment configured\n Tools ready\n PCP standing by\n\nLet's build something amazing!`);
      
      showNotification(` Quick Start: ${solution.name}`, 'success');
    }
    
    // Schedule deep dive session
    function scheduleSession(solutionId) {
      document.querySelectorAll('.pcp-guide-overlay').forEach(overlay => overlay.remove());
      
      addDiamondMessage('assistant', ` DEEP DIVE SESSION SCHEDULED\n\n Planning comprehensive session for ${solutionId}\n\n Duration: 2-4 hours\n Focus: End-to-end implementation\n PCP: Dedicated guidance throughout\n\nI've blocked time in your calendar. Ready when you are!`);
      
      showNotification(' Deep Dive Session Scheduled', 'success');
    }
    
    // Ask PCP question based on context
    function askPCPQuestion(context) {
      const contextMessages = {
        coding: 'What coding question can I help you with? I can assist with debugging, optimization, best practices, or architecture decisions.',
        design: 'What design question do you have? I can help with UI/UX, color schemes, layouts, accessibility, or visual hierarchy.',
        planning: 'What planning aspect would you like to discuss? I can help with strategy, timelines, resource allocation, or risk assessment.'
      };
      
      const message = contextMessages[context] || 'What can I help you with? I\'m here to provide guidance and answer any questions.';
      
      addDiamondMessage('assistant', ` PCP READY TO HELP\n\n ${message}\n\n Just speak naturally or type your question!`);
      
      const input = document.getElementById('diamondCliInput');
      if (input) {
        input.focus();
        input.placeholder = 'Ask your PCP question...';
      }
      
      showNotification(' PCP ready for your question', 'success');
    }
    
    // Approve PCP recommendation
    function approvePCPRecommendation() {
      addDiamondMessage('assistant', ` RECOMMENDATION APPROVED\n\n Excellent! Proceeding with the approved approach\n\n Implementation starting now\n Progress will be tracked in real-time\n I'll keep you updated at each milestone\n\nLet's make this happen!`);
      
      showNotification(' PCP Recommendation Approved - Proceeding!', 'success');
    }
    
    // Request changes from PCP
    function requestPCPChanges() {
      addDiamondMessage('assistant', ` REQUESTING CHANGES\n\n No problem! Let's refine this together\n\n Tell me what you'd like to change:\n Different approach or strategy?\n Modify specific elements?\n Alternative solutions?\n\nI'm here to adapt to your vision!`);
      
      const input = document.getElementById('diamondCliInput');
      if (input) {
        input.focus();
        input.placeholder = 'Tell me what changes you\'d like...';
      }
      
      showNotification(' Ready to make changes per your feedback', 'success');
    }
    
    // Tool blending interface
    function openToolBlendingInterface() {
      const blendOverlay = document.createElement('div');
      blendOverlay.className = 'tool-blend-overlay';
      blendOverlay.id = 'toolBlendOverlay';
      
      blendOverlay.innerHTML = `
        <div class="blend-container">
          <div class="blend-header">
            <h2> PCP Tool Blending</h2>
            <p>Describe your complete project and I'll select and blend the perfect tools</p>
            <button onclick="closeToolBlending()" class="visionspeak-close">&times;</button>
          </div>
          
          <textarea class="blend-input" id="blendProjectInput" placeholder="Describe your complete project naturally...\n\nFor example:\n'I want to create a website for my business with SEO optimization, marketing automation, and e-commerce capabilities. Help me build it from concept to launch.'\n\nOr:\n'Let's build a mobile app with user authentication, real-time chat, and payment processing. I need help with the entire development lifecycle.'">
          </textarea>
          
          <div class="blend-suggestions">
            <div class="suggestion-card" onclick="useBlendSuggestion(0)">
              <h4> Website + Marketing Suite</h4>
              <p>Web development + SEO + Marketing automation + Analytics</p>
            </div>
            <div class="suggestion-card" onclick="useBlendSuggestion(1)">
              <h4> Mobile App Complete</h4>
              <p>Mobile development + Backend + Security + Testing + Deployment</p>
            </div>
            <div class="suggestion-card" onclick="useBlendSuggestion(2)">
              <h4> Business Intelligence</h4>
              <p>Data pipeline + Analytics + Monitoring + Reporting + Dashboards</p>
            </div>
            <div class="suggestion-card" onclick="useBlendSuggestion(3)">
              <h4> Enterprise Automation</h4>
              <p>Workflow + Integration + AI + Security + Governance</p>
            </div>
          </div>
          
          <div class="blend-actions" style="display: flex; gap: 15px; justify-content: center;">
            <button onclick="processToolBlending()" class="primary-action-btn">
               Let PCP Select Tools
            </button>
            <button onclick="closeToolBlending()" class="tertiary-action-btn">
              Cancel
            </button>
          </div>
        </div>
      `;
      
      document.body.appendChild(blendOverlay);
      
      showNotification(' Tool Blending - Describe your complete project!', 'success');
    }
    
    // Process tool blending request
    function processToolBlending() {
      const input = document.getElementById('blendProjectInput');
      const description = input.value.trim();
      
      if (!description) {
        showNotification('Please describe your project first', 'error');
        return;
      }
      
      closeToolBlending();
      
      // Auto-close right panel for focus
      const rightPanel = document.getElementById('rightPanel');
      const contentArea = document.getElementById('contentArea');
      const chatArea = document.getElementById('chatArea');
      
      if (rightPanelState === 'open') {
        rightPanel.classList.add('hidden');
        contentArea.classList.add('full-width');
        chatArea.classList.add('expanded');
        rightPanelState = 'closed';
      }
      
      addDiamondMessage('user', `PCP Tool Blending Request: ${description}`);
      
      // Simulate PCP analysis and tool selection
      setTimeout(() => {
        addDiamondMessage('assistant', ` PCP TOOL ANALYSIS COMPLETE\n\n I've analyzed your project: "${description.substring(0, 100)}${description.length > 100 ? '...' : ''}"\n\n RECOMMENDED TOOL COMBINATION:\n\n Web Development Suite\n Content Management\n Marketing Automation\n Security & Authentication\n Analytics & Monitoring\n\n EXECUTION PLAN:\n1. Start with website foundation\n2. Implement content strategy\n3. Set up marketing automation\n4. Add security layers\n5. Deploy analytics\n\n Would you like me to start with Step 1, or would you prefer to modify this plan?`);
        
        // Apply adaptive layout for web development
        setTimeout(() => {
          applyAdaptiveLayout('coding', { name: 'Web Development Suite' }, 0);
        }, 1000);
      }, 1500);
      
      showNotification(' PCP analyzing and selecting optimal tool combination...', 'success');
    }
    
    // Close tool blending interface
    function closeToolBlending() {
      const overlay = document.getElementById('toolBlendOverlay');
      if (overlay) {
        overlay.remove();
      }
    }
    
    // Use blend suggestion
    function useBlendSuggestion(index) {
      const suggestions = [
        'I want to create a professional business website with SEO optimization, content marketing automation, social media integration, and comprehensive analytics to track performance and user engagement.',
        'I need to develop a mobile application with user registration and authentication, real-time messaging, push notifications, payment processing, and deployment to both iOS and Android app stores.',
        'I want to build a complete business intelligence solution with automated data collection, real-time analytics dashboards, performance monitoring, automated reporting, and predictive insights for decision making.',
        'I need to implement enterprise-wide automation including workflow management, system integrations, AI-powered decision making, security protocols, and governance frameworks for compliance.'
      ];
      
      const input = document.getElementById('blendProjectInput');
      input.value = suggestions[index];
      input.focus();
    }
    
    // Additional PCP interaction handlers
    function approvePlan() {
      addDiamondMessage('assistant', ' Plan approved! Moving to implementation phase with PCP guidance.');
      showNotification(' Plan Approved - Implementation starting', 'success');
    }
    
    function modifyPlan() {
      addDiamondMessage('assistant', ' Ready to modify the plan. What changes would you like to make?');
      const input = document.getElementById('diamondCliInput');
      if (input) input.focus();
    }
    
    function refreshPreview() {
      showNotification(' Preview refreshed with latest changes', 'success');
    }
    
    function fullscreenPreview() {
      showNotification(' Fullscreen preview - Press ESC to exit', 'success');
    }
    
    function requestCodeReview() {
      addDiamondMessage('assistant', ' PCP Code Review: Your code looks good! Here are optimization suggestions...');
    }
    
    function getOptimizationTips() {
      addDiamondMessage('assistant', ' PCP Optimization Tips: Consider caching for better performance, and add error handling...');
    }
    
    // Testing/Production Mode Toggle Function
    function toggleMode() {
      const modeBtn = document.getElementById('modeToggleBtn');
      const modeIcon = document.getElementById('modeIcon');
      const modeText = document.getElementById('modeText');
      
      isProductionMode = !isProductionMode;
      const currentMode = isProductionMode ? MODES.PRODUCTION : MODES.TESTING;
      
      // Update button appearance
      modeIcon.textContent = currentMode.icon;
      modeText.textContent = currentMode.name.toUpperCase();
      modeBtn.style.background = `rgba(${currentMode.color.substring(1).match(/.{2}/g).map(hex => parseInt(hex, 16)).join(', ')}, 0.2)`;
      modeBtn.style.borderColor = `rgba(${currentMode.color.substring(1).match(/.{2}/g).map(hex => parseInt(hex, 16)).join(', ')}, 0.4)`;
      modeBtn.style.color = currentMode.color;
      modeBtn.title = `Currently in ${currentMode.name} Mode - ${currentMode.description}`;
      
      // Show notification with mode change
      const notificationType = isProductionMode ? 'error' : 'success';
      const warningText = isProductionMode ? '   LIVE MODE - Real changes will be applied!' : '   Safe testing environment active';
      
      showNotification(`${currentMode.icon} Switched to ${currentMode.name} Mode${warningText}`, notificationType);
      
      // Add mode change message to chat
      const modeChangeMessage = isProductionMode 
        ? ` PRODUCTION MODE ACTIVATED\n\n  WARNING: All commands will now make LIVE changes to your infrastructure!\n\n DNS changes will affect real traffic\n Worker deployments will go live immediately  \n Database operations will modify production data\n Scaling will affect live applications\n\nProceed with caution!`
        : ` TESTING MODE ACTIVATED\n\n Safe Environment: All commands are now in testing mode\n\n DNS operations will be validated but not applied\n Worker code will be tested but not deployed\n Database operations will be simulated\n Application scaling will be tested\n\nSwitch to Production Mode when ready to apply real changes.`;
        
      addDiamondMessage('assistant', modeChangeMessage);
      
      console.log(` Diamond SAO CLI switched to ${currentMode.name} Mode`);
    }
    
    // Local/Cloud Environment Toggle Function
    function toggleEnvironment() {
      const envBtn = document.getElementById('envToggleBtn');
      const envIcon = document.getElementById('envIcon');
      const envText = document.getElementById('envText');
      
      isCloudMode = !isCloudMode;
      const currentEnv = isCloudMode ? ENVIRONMENTS.CLOUD : ENVIRONMENTS.LOCAL;
      
      // Update button appearance
      envIcon.textContent = currentEnv.icon;
      envText.textContent = currentEnv.name.toUpperCase();
      envBtn.style.background = `rgba(${currentEnv.color.substring(1).match(/.{2}/g).map(hex => parseInt(hex, 16)).join(', ')}, 0.2)`;
      envBtn.style.borderColor = `rgba(${currentEnv.color.substring(1).match(/.{2}/g).map(hex => parseInt(hex, 16)).join(', ')}, 0.4)`;
      envBtn.style.color = currentEnv.color;
      envBtn.title = `Currently in ${currentEnv.name} Mode - ${currentEnv.description}`;
      
      // Show notification
      const notificationType = 'success';
      const infoText = isCloudMode ? '   Cloud infrastructure active' : '   Local development environment';
      
      showNotification(`${currentEnv.icon} Switched to ${currentEnv.name} Environment${infoText}`, notificationType);
      
      // Add environment change message to chat
      const envChangeMessage = isCloudMode 
        ? ` CLOUD ENVIRONMENT ACTIVATED\n\n Global Infrastructure: All operations will target cloud-based services\n\n DNS operations via Google Cloud DNS API\n Workers deployed to Cloudflare global edge network\n MongoDB operations on cloud clusters\n GCP Secrets from cloud secret manager\n App deployments to Cloud Run\n\n Higher latency but production-scale infrastructure.`
        : ` LOCAL ENVIRONMENT ACTIVATED\n\n Local Development: All operations will target local services\n\n DNS operations via local resolver\n Workers tested in local development environment\n MongoDB operations on local database\n Local secrets and configuration files\n Local application development server\n\n Faster development cycle with local resources.`;
        
      addDiamondMessage('assistant', envChangeMessage);
      
      console.log(` Diamond SAO CLI switched to ${currentEnv.name} Environment`);
    }
    
    // Image Handling Functions
    function openImageHandler() {
      const fileInput = document.getElementById('imageFileInput');
      fileInput.click();
    }
    
    function handleImageUpload(event) {
      const files = Array.from(event.target.files);
      
      if (files.length === 0) return;
      
      // Filter supported image formats
      const validImages = files.filter(file => {
        const extension = file.name.toLowerCase().split('.').pop();
        return SUPPORTED_IMAGE_FORMATS.includes(extension);
      });
      
      if (validImages.length === 0) {
        showNotification(' No valid image files selected. Supported formats: ' + SUPPORTED_IMAGE_FORMATS.join(', '), 'error');
        return;
      }
      
      // Process each valid image
      validImages.forEach(file => {
        const imageInfo = {
          name: file.name,
          size: file.size,
          type: file.type,
          localPath: isCloudMode ? null : `${currentImageDirectory}/${file.name}`,
          cloudPath: isCloudMode ? `gs://asoos-assets/images/${file.name}` : null,
          timestamp: new Date().toISOString()
        };
        
        imageAssets.push(imageInfo);
        
        // Create image preview URL
        const imageUrl = URL.createObjectURL(file);
        
        // Add image processing message
        const imageMessage = isCloudMode 
          ? ` Image Added to Cloud Storage\n\n File: ${file.name}\n Size: ${formatFileSize(file.size)}\n Cloud Path: gs://asoos-assets/images/${file.name}\n Storage: Google Cloud Storage\n\n Image ready for web deployment. Use path in HTML: \n<img src="/images/${file.name}" alt="${file.name.split('.')[0]}" />\n\n CDN URL: https://cdn.aipub.2100.cool/images/${file.name}`
          : ` Image Added to Local Directory\n\n File: ${file.name}\n Size: ${formatFileSize(file.size)}\n Local Path: ${currentImageDirectory}/${file.name}\n Storage: Local Development\n\n Image ready for development. Use relative path in HTML:\n<img src="./assets/images/${file.name}" alt="${file.name.split('.')[0]}" />\n\n Switch to Cloud mode to deploy to production CDN.`;
          
        addDiamondMessage('assistant', imageMessage);
      });
      
      // Show summary notification
      const summary = validImages.length === 1 
        ? ` 1 image added to ${isCloudMode ? 'cloud storage' : 'local directory'}` 
        : ` ${validImages.length} images added to ${isCloudMode ? 'cloud storage' : 'local directory'}`;
        
      showNotification(summary, 'success');
      
      // Clear file input
      event.target.value = '';
      
      console.log(` ${validImages.length} images processed in ${isCloudMode ? 'Cloud' : 'Local'} mode`);
    }
    
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    // Enhanced web development commands
    function handleWebDevelopmentCommands(command) {
      const lowerCommand = command.toLowerCase();
      
      if (lowerCommand.includes('add image') || lowerCommand.includes('upload image')) {
        // Trigger image upload
        openImageHandler();
        return {
          response: ` Image Upload Interface Opened\n\n Diamond SAO will help you add images to your ${isCloudMode ? 'cloud storage' : 'local project'}:\n\n Select multiple image files\n Automatic format validation (${SUPPORTED_IMAGE_FORMATS.join(', ')})\n ${isCloudMode ? 'Cloud storage with CDN URLs' : 'Local development paths'}\n Ready-to-use HTML img tags\n\nPlease select your image files in the file dialog.`,
          service: 'images'
        };
      }
      
      if (lowerCommand.includes('create web page') || lowerCommand.includes('build website')) {
        return {
          response: ` Web Page Creation Ready\n\n Diamond SAO can help you build web pages with:\n\n  Image integration (${imageAssets.length} images available)\n  Responsive HTML/CSS generation\n  ${isCloudMode ? 'Cloud deployment pipeline' : 'Local development server'}\n  Asset optimization and CDN integration\n\nTell me what kind of web page you want to create!`,
          service: 'webdev'
        };
      }
      
      return null;
    }
    
    // View Mode Management
    let currentView = 'chat';
    let selectedSecurityOption = null;
    
    function switchView(view) {
      const chatArea = document.getElementById('chatArea');
      const splitView = document.getElementById('splitView');
      const chatViewBtn = document.getElementById('chatViewBtn');
      const splitViewBtn = document.getElementById('splitViewBtn');
      const previewViewBtn = document.getElementById('previewViewBtn');
      
      // Reset all buttons
      [chatViewBtn, splitViewBtn, previewViewBtn].forEach(btn => btn.classList.remove('active'));
      
      currentView = view;
      
      switch(view) {
        case 'chat':
          chatArea.style.display = 'flex';
          splitView.style.display = 'none';
          chatViewBtn.classList.add('active');
          break;
          
        case 'split':
          chatArea.style.display = 'none';
          splitView.style.display = 'flex';
          splitViewBtn.classList.add('active');
          updatePreview();
          break;
          
        case 'preview':
          chatArea.style.display = 'none';
          splitView.style.display = 'flex';
          // Hide code panel for preview-only mode
          const codePanel = document.querySelector('.code-editor-panel');
          codePanel.style.display = 'none';
          previewViewBtn.classList.add('active');
          updatePreview();
          break;
      }
    }
    
    function switchCodeTab(tabElement, codeType) {
      // Remove active from all tabs
      document.querySelectorAll('.code-tab').forEach(tab => tab.classList.remove('active'));
      
      // Hide all code content
      document.querySelectorAll('.code-content').forEach(content => content.style.display = 'none');
      
      // Activate selected tab and show content
      tabElement.classList.add('active');
      document.getElementById(codeType).style.display = 'block';
      
      // Update preview if we're in split view
      if (currentView === 'split') {
        setTimeout(updatePreview, 100);
      }
    }
    
    function updatePreview() {
      const htmlCode = document.getElementById('htmlCode').textContent;
      const cssCode = document.getElementById('cssCode').textContent;
      const jsCode = document.getElementById('jsCode').textContent;
      
      const previewFrame = document.getElementById('previewFrame');
      
      const fullHTML = `
        <!DOCTYPE html>
        <html lang="en">
        <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>Diamond SAO Live Preview</title>
          <style>
            ${cssCode}
          </style>
        </head>
        <body>
          ${htmlCode}
          <script>
            ${jsCode}
          </script>
        </body>
        </html>
      `;
      
      previewFrame.srcdoc = fullHTML;
    }
    
    // Security Prompt Functionality
    function showSecurityPrompt() {
      const securityPrompt = document.getElementById('securityPrompt');
      securityPrompt.style.display = 'flex';
    }
    
    function closeSecurityPrompt() {
      const securityPrompt = document.getElementById('securityPrompt');
      securityPrompt.style.display = 'none';
      selectedSecurityOption = null;
      
      // Reset all option selections
      document.querySelectorAll('.prompt-option').forEach(option => {
        option.style.background = 'rgba(255, 255, 255, 0.05)';
        option.style.borderColor = 'rgba(124, 58, 237, 0.3)';
      });
    }
    
    function selectSecurityOption(optionType) {
      selectedSecurityOption = optionType;
      
      // Reset all options
      document.querySelectorAll('.prompt-option').forEach(option => {
        option.style.background = 'rgba(255, 255, 255, 0.05)';
        option.style.borderColor = 'rgba(124, 58, 237, 0.3)';
      });
      
      // Highlight selected option
      const selectedElement = event.target.closest('.prompt-option');
      selectedElement.style.background = 'rgba(124, 58, 237, 0.2)';
      selectedElement.style.borderColor = 'rgba(124, 58, 237, 0.6)';
    }
    
    function applySecurityOption() {
      if (!selectedSecurityOption) {
        showNotification('Please select a security option first', 'error');
        return;
      }
      
      const securityDetails = {
        oauth: {
          name: 'OAuth 2.0 / OIDC',
          implementation: 'Google Cloud Identity, Auth0 integration',
          code: 'oauth2-implementation.js'
        },
        jwt: {
          name: 'JWT Authentication',
          implementation: 'RS256 signed tokens with secure headers',
          code: 'jwt-auth.js'
        },
        mfa: {
          name: 'Multi-Factor Authentication',
          implementation: 'SMS, authenticator app, biometric options',
          code: 'mfa-handler.js'
        },
        encryption: {
          name: 'End-to-End Encryption',
          implementation: 'AES-256 with RSA key exchange',
          code: 'e2e-encryption.js'
        }
      };
      
      const selected = securityDetails[selectedSecurityOption];
      
      // Update code with security implementation
      const jsCodeElement = document.getElementById('jsCode');
      const currentCode = jsCodeElement.textContent;
      const securityCode = `
// ${selected.name} Implementation
// Generated by Diamond SAO Security Assistant

class SecurityManager {
  constructor() {
    this.type = '${selectedSecurityOption}';
    this.implementation = '${selected.implementation}';
    console.log(' Security initialized: ${selected.name}');
  }
  
  async authenticate(credentials) {
    // ${selected.name} authentication logic
    console.log(' Authenticating with ${selected.name}');
    return { success: true, token: 'secure_token_here' };
  }
}

// Initialize security on page load
const security = new SecurityManager();
`;
      
      jsCodeElement.textContent = currentCode + securityCode;
      
      // Switch to JavaScript tab to show the new code
      switchCodeTab(document.querySelector('.code-tab:last-child'), 'jsCode');
      
      // Update preview
      updatePreview();
      
      // Close prompt
      closeSecurityPrompt();
      
      // Show success notification
      showNotification(` ${selected.name} security implementation added to your project`, 'success');
      
      // Add Diamond SAO message
      addDiamondMessage('assistant', ` Security Implementation Added\n\n Type: ${selected.name}\n Implementation: ${selected.implementation}\n Code: Added to JavaScript tab\n\n Diamond SAO has automatically integrated the security layer into your web application. The code is ready for ${isCloudMode ? 'cloud deployment' : 'local testing'}.\n\n You can customize the implementation by editing the JavaScript code directly.`);
    }
    
    // Enhanced command processing to detect security requests
    function detectSecurityNeeds(command) {
      const securityKeywords = [
        'secure', 'security', 'authentication', 'auth', 'login', 'password',
        'encrypt', 'encryption', 'oauth', 'jwt', 'token', 'mfa', '2fa', 'banking',
        'financial', 'payment', 'credit card', 'sensitive', 'private'
      ];
      
      const lowerCommand = command.toLowerCase();
      
      for (let keyword of securityKeywords) {
        if (lowerCommand.includes(keyword)) {
          return true;
        }
      }
      
      return false;
    }
    
    // Update processDiamondCommand to handle security prompts
    const originalProcessDiamondCommand = processDiamondCommand;
    
    async function processDiamondCommand(command) {
      // Check for web development commands first
      const webCommand = handleWebDevelopmentCommands(command);
      if (webCommand) {
        return webCommand;
      }
      
      // Check if security assistance is needed
      if (detectSecurityNeeds(command)) {
        // Switch to split view if not already there
        if (currentView === 'chat') {
          switchView('split');
        }
        
        // Show security prompt after a short delay
        setTimeout(() => {
          showSecurityPrompt();
        }, 1000);
        
        return {
          response: ` Security Implementation Detected\n\n Diamond SAO has detected your request involves security features:\n"${command}"\n\n I'm opening the smart security prompt to help you choose the best security implementation for your needs.\n\n Switching to development view for real-time code integration...`,
          service: 'security'
        };
      }
      
      // Fall back to original processing
      return await originalProcessDiamondCommand(command);
    }
  </script>
</body>
</html>
